<!DOCTYPE html>
<html lang="en" xml:lang="en">

  <head>
  
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Upgrading NPM in Visual Studio 2015 | Western Devs</title>
  <meta name="description" content="Visual Studio 2015 (download here) ships with it&#39;s own version of several external tools, such as grunt, node and npm.  If you are wanting to take advantage of newer versions of these tools, you have">
<meta property="og:type" content="article">
<meta property="og:title" content="Upgrading NPM in Visual Studio 2015">
<meta property="og:url" content="https://westerndevs.com/_/upgrading-npm-in-visual-studio-2015/index.html">
<meta property="og:site_name" content="Western Devs">
<meta property="og:description" content="Visual Studio 2015 (download here) ships with it&#39;s own version of several external tools, such as grunt, node and npm.  If you are wanting to take advantage of newer versions of these tools, you have">
<meta property="og:image" content="http://jameschambers.com/wp-content/uploads/2015/09/image_thumb.png">
<meta property="og:image" content="http://jameschambers.com/wp-content/uploads/2015/09/image_thumb1.png">
<meta property="og:image" content="http://jameschambers.com/wp-content/uploads/2015/09/wlEmoticon-smile.png">
<meta property="article:published_time" content="2015-09-03T02:31:14.000Z">
<meta property="article:modified_time" content="2024-01-29T19:23:30.969Z">
<meta property="article:author" content="Western Devs">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://jameschambers.com/wp-content/uploads/2015/09/image_thumb.png">
<meta name="twitter:creator" content="@westerndevs">

    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="title" content="WesternDevs">   
    <meta name="keywords" content="software development,software,asp.net,blog">
    <meta name="description" content="We're all west of somewhere">
    <meta name="copyright" content="WesternDevs">
    <meta name="revisit-after" content="15 days">
    <meta name="robots" content="all">
    <meta name="MSSmartTagsPreventParsing" content="true">
  
    <link rel="canonical" href="http://jameschambers.com/2015/09/upgrading-npm-in-visual-studio-2015/">
  
  
    <link rel="alternate" href="/feed.xml" title="Western Devs" type="application/atom+xml">
  
  
<link rel="stylesheet" href="/css/style.css">

      
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <script src="//code.jquery.com/jquery-1.11.3.min.js"></script>  
  <meta name="generator" content="Hexo 4.2.1"></head>

<body>

<!-- FIXED HEADER BECAUSE SCROLLING -->
<!--HEADER STARTS-->
<div class="WrapperHeader">
<div style="display:inline-block; text-align: center;">
<div class="Header">

  <div class="HeaderLogo">
    <a href="/"><img src="/images/header_logo_transparent.png" alt="WesternDevs" title="WesternDevs" border="0" style="width: 206px; height: 64px;" width="206" height="64"></a>
  </div>

  <div class="HeaderLinks">
      <a href="/posts" class="nav">POSTS</a>       
      <a href="/podcasts" class="nav">PODCASTS</a>       
      <a href="/whoweare" class="nav">ABOUT</a>  
      <a href="/whatwevedone" class="nav">WHAT WE'VE DONE</a>  
      <a href="/speaking" class="nav">SPEAKING</a>
      <div class="HeaderIcons">
        <a href="mailto:info@westerndevs.com"><img src="/images/icon_email.png" border="0" alt="Email" title="Email" height="26" width="26"></a>
        <a href="/feed.xml"><img src="/images/icon_subscribe.png" border="0" alt="Subscribe" title="Subscribe" height="26" width="27"></a>
        <a href="http://twitter.com/westerndevs" target="_blank"><img src="/images/icon_twitter.png" border="0" alt="Twitter" title="Twitter" height="26" width="27"></a>
        <a href="http://github.com/westerndevs" target="_blank"><img src="/images/icon_github.png" border="0" alt="GitHub" title="GitHub" height="26" width="27"></a>     
      </div>
  </div>
  
</div>
</div>
</div>
<!--HEADER ENDS-->    



<!--WRAPPER STARTS-->
<div class="Wrapper" style="">

<!--SUBHEAD STARTS-->
<div class="WrapperSubHeaderSubpage">
<center>
	<div class="SubHeader">
		<H1 class="title"><img class="icon" src="/images/icon_posts.png" alt="POST" title="POST" border="0"> POST</H1>
	</div>
</center>
</div>
<!--SUBHEAD ENDS-->

<!--PAGE CONTENT STARTS-->
<center>
<div class="WrapperContent">

<!--MAIN CONTENT STARTS-->
	<div class="SubpageBoxSubLrg">
		<div class="SubpageBoxSubLrgContent">
		    <div class='postTitle'>
  <div class="ListLrgDateBG">
    <div class="ListLrgDateMonth">SEP</div>
    <div class="ListLrgDateDay">3</div>
    <div class="ListLrgDateYear">2015</div>
  </div>
  <h2>Upgrading NPM in Visual Studio 2015</h2>
</div>

		    

<p class="TXTsm">ORIGINALLY POSTED TO: <a href="http://jameschambers.com/2015/09/upgrading-npm-in-visual-studio-2015/" target="_blank" rel="noopener" class='originalurl'>http://jameschambers.com/2015/09/upgrading-npm-in-visual-studio-2015/</a></p>



			<div id="mainPostContent">
	        <p>Visual Studio 2015 (<a href="https://www.visualstudio.com/?Wt.mc_id=DX_MVP4038205" target="_blank" rel="noopener"><em>download here</em></a>) ships with it's own version of several external tools, such as grunt, node and npm.  If you are wanting to take advantage of newer versions of these tools, you have three options:</p>
<a id="more"></a>
<ol>
<li>Wait for VS 2015 to upgrade the tooling and ship an update.</li>
<li>Hack the tooling proxies used by Visual Studio.</li>
<li>Use the built-in external tool path editor to slip your updated versions in.</li>
</ol>
<p>Waiting for updates is no fun. Let's hack a little.</p>
<h2>Wait a minute! Why are we doing this?</h2>
<img src="http://jameschambers.com/wp-content/uploads/2015/09/image_thumb.png" class="pull-right">
<p>For me the primary motivator was the path length limitations in Windows. Nested node_modules folders buried 19 levels deep is no fun when you hit the max path length. For me, I was trying to share the files on OneDrive and hit 255 characters pretty quickly.</p>
<p>Older versions of npm resolved package dependencies by pulling in a package, creating a node_modules folder inside of it, then putting all the packages in there. Except, of course, if one of those packages contained more dependencies, then we were into the recursive bits of package resolution and very deep paths, ultimately toppling a lot of Windows tooling.</p>
<p>The latest major version of npm – version 3.0.x and above – creates a flat store of packages (very similar to what we know in NuGet) and only pulls one copy of each required version of each required package. Much nicer. So, back to the dicing!</p>
<h2>Hacking up the VS Tooling Proxies</h2>
<p>These are pretty straightforward, once you find them. For me, they were located in the following directory:</p>
<p>C:\Program Files (x86)\Microsoft Visual Studio 14.0\Common7\IDE\Extensions\Microsoft\Web Tools\External</p>
<p>For example, here the entire contents of npm.cmd:</p>
<pre><code>@&quot;%~dp0\node\node&quot; &quot;%~dp0\npm\node_modules\npm\bin\npm-cli.js&quot; %*
</code></pre>
<p>The %~dp0 is the old command line way of bringing the current drive letter (the d in the command), the path (the letter p here) and the current directory of the executing script (represented by 0) into context. So, basically, &quot;start from where you're running&quot;. It's a very hard-to-read version of &quot;.&quot; in most other notations. So, the command is running node (which is an exe), passing in the VS version of npm, and pushing into it the rest of the parameters that were passed along. So, when VS issues an &quot;npm install&quot;, this command kicks in, runs npm via node and passes &quot;install&quot; as the command to npm.</p>
<p>With that knowledge, we can simply update the call that is proxied through to our current version. I installed node (which includes npm), then updated npm to the latest version (thanks to <a href="https://www.npmjs.com/package/npm-windows-upgrade" target="_blank" rel="noopener"><em>this module</em></a>) and updated my npm.cmd to the following:</p>
<pre><code>@&quot;C:\Program Files (x86)\nodejs\node.exe&quot; &quot;C:\Program Files (x86)\nodejs\node_modules\npm\bin\npm-cli.js&quot; %*
</code></pre>
<p>Of course, here be dragons: I have no idea how stable this will be with updates to VS, and/or how badly you may be crippling features if you mess this up. So, make sure you take a backup of your scripts before modifying them.  This will be super-handy if you have some other requirement – like the order of params on tooling changes – but otherwise likely isn't needed. Thankfully, there is a UI-way of doing this, too.</p>
<h2>Not Hacking Your Visual Studio Tooling</h2>
<p>Probably a more pleasing solution for your boss.</p>
<p>This one is pretty straightforward as well, and can be done by right-clicking on the &quot;Dependencies&quot; node in Solution Explorer, or by typing &quot;external web tools&quot; in the QuickLaunch bar.</p>
<p>From here, just add a new entry and move it to the top. For me, npm is located in the nodejs install directory, and this is good enough to get VS to see it first.</p>
<p><img src="http://jameschambers.com/wp-content/uploads/2015/09/image_thumb1.png" alt="image" title="image"></p>
<p>Note, I did seem to have some issues with caching and/or gremlins here, so you may need to restart Visual Studio for the tooling paths to be picked up.</p>
<h2>What I Don't Like</h2>
<p>Couple of things here that I don't care for:</p>
<ol>
<li><strong>Not consistent between team members</strong>: there seems to be no way to put in your solution/project a hint at the version of tooling you wish to use. In my case, a developer with npm 2 trying to run an install off of OneDrive would fail.</li>
<li><strong>Visual Studio external tools are internal</strong>: yeah, you read that right. I'm not a fan of the way these projects are packed in, in such a way that the path to update them or pick versions is non-obvious.</li>
</ol>
<h2>Next Steps</h2>
<p>Not too much to do, but if you run into long paths, nested node_modules kicking your butt or other out-of-date tooling, this should get you on your way.</p>
<p>Make sure you grab your <a href="https://www.visualstudio.com/?Wt.mc_id=DX_MVP4038205" target="_blank" rel="noopener"><em>copy of VS 2015</em></a> and start diving into the next phase of our careers!</p>
<p>Happy coding! <img src="http://jameschambers.com/wp-content/uploads/2015/09/wlEmoticon-smile.png" alt="Smile"></p>

	        </div>

            
            <section id="comments">
            <div id="disqus_thread">
                <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript" target="_blank" rel="noopener">comments powered by Disqus.</a></noscript>
            </div>
            </section>
            
		</div>
	</div>
<!--MAIN CONTENT ENDS-->

<!--SIDEBAR CONTENT STARTS-->
	<div class="SubpageBoxSubSm">
		<div class="SubpageBoxSubSmContent">
			
			

			<div class="ProfileImg">
				
				<a href="/bios/james_chambers">
				
					<img src='https://www.gravatar.com/avatar/1ac8c631c34a86ddcfb6ae67f6a7a551?s=200' />
				
				</a>
				
			</div>

			<BR clear="all">

			<h2><a href="/bios/james_chambers">James Chambers</a></h2>
			
			<a href="mailto:james@jameschambers.com"><img class="ProfileIcon" src="/images/icon_email.png" border="0" alt="Email" title="Email"> Email</a><BR>
			
			
			<a href="http://jameschambers.com/" target="_blank"><img class="ProfileIcon" src="/images/icon_web.png" border="0" alt="Web" title="Web"> Web</a><BR>
			
			
			<a href="http://twitter.com/canadianjames" target="_blank"><img class="ProfileIcon" src="/images/icon_twitter.png" border="0" alt="Twitter" title="Twitter"> Twitter</a><BR>
			
			
			<a href="https://github.com/MisterJames" target="_blank"><img class="ProfileIcon" src="/images/icon_github.png" border="0" alt="GitHub" title="GitHub"> GitHub</a><br>
			
			
			<a href="https://www.linkedin.com/in/canadianjames" target="_blank"><img class="ProfileIcon" src="/images/icon_linkedin.png" border="0" alt="LinkedIN" title="LinkedIN"> LinkedIn</a><br>
			
			
 			<a href="/feeds/james_chambers.xml"><img class="ProfileIcon" src="/images/icon_subscribe.png" /> RSS</a>
			

			<hr />
			<h4>Looking for someone else?</h4>
			<p>You can find the rest of the Western Devs Crew <a href="/whoweare">here</a>.</p>
		</div>
	</div>
<!--SIDEBAR CONTENT ENDS-->


</div>
</center>
<!--PAGE CONTENT ENDS-->


<!--FOOTER STARTS-->
<center>
  <div class="FooterBarTxt">&copy; 2015 Western Devs. All Rights Reserved. Design by <a href="http://www.karenchudobiak.ca" target="_blank">Karen Chudobiak, Graphic Designer</a></div>
</center>
<!--FOOTER ENDS-->

<!-- NAV FOOTER STARTS -->
<div class="NavFooter">
  <a href="/posts" alt="Posts"><i class="fa fa-newspaper-o fa-2x"></i><span>Posts</span></a>
  <a href="/podcasts" alt="Podcasts"><i class="fa fa-volume-up fa-2x"></i><span>Podcasts</span></a>
  <a href="/whoweare" alt="About"><i class="fa fa-star fa-2x"></i><span>About</span></a>
  <a href="/whatwevedone" alt="What We've Done"><i class="fa fa-trophy fa-2x"></i><span>Work</span></a>
  <a href="/speaking" alt="Speaking"><i class="fa fa-comment-o fa-2x fa-flip-horizontal"></i><span>Speaking</span></a>
</div>
<!-- NAV FOOTER ENDS -->




</div>
<!--WRAPPER ENDS-->


<script>
  var disqus_shortname = 'westerndevs';
  
  var disqus_url = 'https://westerndevs.com/_/upgrading-npm-in-visual-studio-2015/'.replace(".com//", ".com/");
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
  
function shuffle(array) {
  var currentIndex = array.length, temporaryValue, randomIndex;

  // While there remain elements to shuffle...
  while (0 !== currentIndex) {

    // Pick a remaining element...
    randomIndex = Math.floor(Math.random() * currentIndex);
    currentIndex -= 1;

    // And swap it with the current element.
    temporaryValue = array[currentIndex];
    array[currentIndex] = array[randomIndex];
    array[randomIndex] = temporaryValue;
  }

  return array;
}

</script>


</body>

  
<!-- Google Analytics -->
<script type="text/javascript">
if (document.location.hostname.search("westerndevs.com") !== -1 || document.location.hostname.search("www.westerndevs.com") !== -1) {
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-37617956-2', 'auto');

ga('set', 'contentGroup1', 'james_chambers');

ga('send', 'pageview');
}
</script>
<!-- End Google Analytics -->



</html>
