<!DOCTYPE html>
<html lang="en" xml:lang="en">

  <head>
  
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Using IE Automation in PowerShell to Simplify Browser Based Tasks | Western Devs</title>
  <meta name="description" content="As a consultant, one of the things that I need to do regularly is log into my client&#39;s WiFi networks. Sometimes this is a once per month task, sometimes it is a daily task. It was a daily version of t">
<meta property="og:type" content="article">
<meta property="og:title" content="Using IE Automation in PowerShell to Simplify Browser Based Tasks">
<meta property="og:url" content="https://westerndevs.com/_/simple-powershell-automation-browser-based-tasks/index.html">
<meta property="og:site_name" content="Western Devs">
<meta property="og:description" content="As a consultant, one of the things that I need to do regularly is log into my client&#39;s WiFi networks. Sometimes this is a once per month task, sometimes it is a daily task. It was a daily version of t">
<meta property="og:image" content="http://agileramblings.files.wordpress.com/2015/07/image_thumb.png?w=244&amp;h=186">
<meta property="og:image" content="http://agileramblings.files.wordpress.com/2015/07/image_thumb1.png?w=244&amp;h=219">
<meta property="og:image" content="http://agileramblings.files.wordpress.com/2015/07/image_thumb2.png?w=244&amp;h=80">
<meta property="article:published_time" content="2015-07-25T03:30:00.000Z">
<meta property="article:modified_time" content="2023-02-16T14:34:09.551Z">
<meta property="article:author" content="Western Devs">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://agileramblings.files.wordpress.com/2015/07/image_thumb.png?w=244&amp;h=186">
<meta name="twitter:creator" content="@westerndevs">

    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="title" content="WesternDevs">   
    <meta name="keywords" content="software development,software,asp.net,blog">
    <meta name="description" content="We're all west of somewhere">
    <meta name="copyright" content="WesternDevs">
    <meta name="revisit-after" content="15 days">
    <meta name="robots" content="all">
    <meta name="MSSmartTagsPreventParsing" content="true">
  
    <link rel="canonical" href="http://agileramblings.com/2015/07/22/using-ie-automation-in-powershell-to-simplify-tasks/">
  
  
    <link rel="alternate" href="/feed.xml" title="Western Devs" type="application/atom+xml">
  
  
<link rel="stylesheet" href="/css/style.css">

      
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <script src="//code.jquery.com/jquery-1.11.3.min.js"></script>  
  <meta name="generator" content="Hexo 4.2.1"></head>

<body>

<!-- FIXED HEADER BECAUSE SCROLLING -->
<!--HEADER STARTS-->
<div class="WrapperHeader">
<div style="display:inline-block; text-align: center;">
<div class="Header">

  <div class="HeaderLogo">
    <a href="/"><img src="/images/header_logo_transparent.png" alt="WesternDevs" title="WesternDevs" border="0" style="width: 206px; height: 64px;" width="206" height="64"></a>
  </div>

  <div class="HeaderLinks">
      <a href="/posts" class="nav">POSTS</a>       
      <a href="/podcasts" class="nav">PODCASTS</a>       
      <a href="/whoweare" class="nav">ABOUT</a>  
      <a href="/whatwevedone" class="nav">WHAT WE'VE DONE</a>  
      <a href="/speaking" class="nav">SPEAKING</a>
      <div class="HeaderIcons">
        <a href="mailto:info@westerndevs.com"><img src="/images/icon_email.png" border="0" alt="Email" title="Email" height="26" width="26"></a>
        <a href="/feed.xml"><img src="/images/icon_subscribe.png" border="0" alt="Subscribe" title="Subscribe" height="26" width="27"></a>
        <a href="http://twitter.com/westerndevs" target="_blank"><img src="/images/icon_twitter.png" border="0" alt="Twitter" title="Twitter" height="26" width="27"></a>
        <a href="http://github.com/westerndevs" target="_blank"><img src="/images/icon_github.png" border="0" alt="GitHub" title="GitHub" height="26" width="27"></a>     
      </div>
  </div>
  
</div>
</div>
</div>
<!--HEADER ENDS-->    



<!--WRAPPER STARTS-->
<div class="Wrapper" style="">

<!--SUBHEAD STARTS-->
<div class="WrapperSubHeaderSubpage">
<center>
	<div class="SubHeader">
		<H1 class="title"><img class="icon" src="/images/icon_posts.png" alt="POST" title="POST" border="0"> POST</H1>
	</div>
</center>
</div>
<!--SUBHEAD ENDS-->

<!--PAGE CONTENT STARTS-->
<center>
<div class="WrapperContent">

<!--MAIN CONTENT STARTS-->
	<div class="SubpageBoxSubLrg">
		<div class="SubpageBoxSubLrgContent">
		    <div class='postTitle'>
  <div class="ListLrgDateBG">
    <div class="ListLrgDateMonth">JUL</div>
    <div class="ListLrgDateDay">25</div>
    <div class="ListLrgDateYear">2015</div>
  </div>
  <h2>Using IE Automation in PowerShell to Simplify Browser Based Tasks</h2>
</div>

		    

<p class="TXTsm">ORIGINALLY POSTED TO: <a href="http://agileramblings.com/2015/07/22/using-ie-automation-in-powershell-to-simplify-tasks/" target="_blank" rel="noopener" class='originalurl'>http://agileramblings.com/2015/07/22/using-ie-automation-in-powershell-to-simplify-tasks/</a></p>



			<div id="mainPostContent">
	        <p>As a consultant, one of the things that I need to do regularly is log into my client's WiFi networks. Sometimes this is a once per month task, sometimes it is a daily task. It was a daily version of this task that made me look into doing this a bit quicker. Opening Internet Explorer (or any browser) and then navigating to the page, typing in all of my credentials, and then submitting the request is a fairly monotonous task, and it isn't very quick.</p>
<a id="more"></a>
<p>Now a days, I almost always have a PowerShell window open, and because of another little experiment I did with PowerShell and IE, I thought it should be easy to automate my WiFi network login. So I that is what I set out to do.</p>
<p>The way that I'm currently working in PowerShell is to create a .ps1 file to do my development in. That way I can version control the file, and keep it separate from other things that are working or in progress. So in this case, I made a PowerShell script file called Login-GuestWifi.ps1. In this file, I just started typing lines of PowerShell script and eventually I would move it into a CmdLet or a function somewhere else.</p>
<p>The first line in the PowerShell script is a call to create an Internet Explorer Application.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ie</span> = <span class="built_in">new-object</span> <span class="literal">-ComObject</span> <span class="string">"InternetExplorer.Application"</span></span><br></pre></td></tr></table></figure>
<p>Now that you've got IE in your PowerShell code, you need to figure out what to do with this. This is going to require a little bit of work in the browser so you're going to have to open a browser and navigate to the page you're going to be working with. In my case, this was an internal IP address that I was re-directed to when using the browser for the first time on the guest WiFi network.</p>
<p>http://10.10.10.10 â€“ Example URL</p>
<p><img src="http://agileramblings.files.wordpress.com/2015/07/image_thumb.png?w=244&amp;h=186" alt="image" title="image"></p>
<p>Once I've navigated there, I press F12 to get to the developer tools of my browser. (I'll use IE for my examples)</p>
<p><img src="http://agileramblings.files.wordpress.com/2015/07/image_thumb1.png?w=244&amp;h=219" alt="image" title="image"></p>
<p>Using the Dev Tools, I'm going to discover what the fields I need to fill in are (their id or class). In this case, I found fragments of ids that were not generated. I took those fragments and put them into my PowerShell code along with URL of the login page.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$requestUri</span> = http://<span class="number">10.10</span>.<span class="number">10.10</span>/guest/wifi<span class="literal">-guest</span>.php</span><br><span class="line"><span class="variable">$userIdFragment</span> = <span class="string">"weblogin_user"</span>;</span><br><span class="line"><span class="variable">$passwordIdFragment</span> = <span class="string">"weblogin_password"</span>;</span><br><span class="line"><span class="variable">$acceptTermsInputFragment</span> = <span class="string">"weblogin_visitor_accept_terms"</span></span><br><span class="line"><span class="variable">$buttonIdFragment</span> = <span class="string">"weblogin_submit"</span>;</span><br></pre></td></tr></table></figure>
<p>I now have details of where to go and ability to find the elements on the page that I'm interested in. I'm going to now invoke some methods on the IE Application instance I have to navigate to the Url.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#$ie.visible = $true</span></span><br><span class="line"><span class="variable">$ie</span>.silent = <span class="variable">$true</span></span><br><span class="line"><span class="variable">$ie</span>.navigate(<span class="variable">$requestUri</span>)</span><br><span class="line"><span class="keyword">while</span>(<span class="variable">$ie</span>.Busy) &#123; <span class="built_in">Start-Sleep</span> <span class="literal">-Milliseconds</span> <span class="number">100</span> &#125;</span><br></pre></td></tr></table></figure>
<p>The first two lines indicate how IE is supposed to behave in two ways and the first one is commented out.</p>
<ol>
<li>Show the instance of IE. With this line commented out, we get a &quot;headless&quot; browsing experience with no visible window or rendering.  <a href="https://msdn.microsoft.com/en-us/library/aa752082%28v=vs.85%29.aspx" target="_blank" rel="noopener" title="https://msdn.microsoft.com/en-us/library/aa752082%28v=vs.85%29.aspx">Visible Property - MSDN</a></li>
<li>Do not show any dialogs that may pop up. <a href="https://msdn.microsoft.com/en-us/library/aa752074(v=vs.85).aspx" target="_blank" rel="noopener" title="https://msdn.microsoft.com/en-us/library/aa752074(v=vs.85).aspx">Silent Property - MSDN</a></li>
</ol>
<p>The next instruction tells IE to navigate to the Url provided.</p>
<p>The 4th line of this script fragment is interesting. We need to wait for IE to actually do the navigation. If we don't add this line, the PowerShell script will happily continue executing much faster than IE will retrieve and load the page into the Document Object Model (DOM) and the rest of your script will probably fail.</p>
<p>After IE has loaded up the DOM, we can now find our elements, give them values, and click the Submit button.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$doc</span> = <span class="variable">$ie</span>.Document</span><br><span class="line"><span class="variable">$doc</span>.getElementsByTagName(<span class="string">"input"</span>) | % &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$_</span>.id <span class="operator">-ne</span> <span class="variable">$null</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$_</span>.id.Contains(<span class="variable">$buttonIdFragment</span>)) &#123; <span class="variable">$btn</span> = <span class="variable">$_</span> &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$_</span>.id.Contains(<span class="variable">$acceptTermsInputFragment</span>)) &#123; <span class="variable">$at</span> = <span class="variable">$_</span> &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$_</span>.id.Contains(<span class="variable">$passwordIdFragment</span>)) &#123; <span class="variable">$pwd</span> = <span class="variable">$_</span> &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$_</span>.id.Contains(<span class="variable">$userIdFragment</span>)) &#123; <span class="variable">$user</span> = <span class="variable">$_</span> &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$user</span>.value = <span class="string">"&lt;user name="</span><span class="string">" here="</span><span class="string">"&gt;"</span></span><br><span class="line"><span class="variable">$pwd</span>.value = <span class="string">"&lt;password here="</span><span class="string">"&gt;"</span></span><br><span class="line"><span class="variable">$at</span>.checked = <span class="string">"checked"</span></span><br><span class="line"><span class="variable">$btn</span>.disabled = <span class="variable">$false</span></span><br><span class="line"><span class="variable">$btn</span>.click()</span><br><span class="line"><span class="built_in">Write-Verbose</span> <span class="string">"Login Complete"</span></span><br></pre></td></tr></table></figure>
<p>One interesting thing about IE automation is that any JavaScript or page behaviours that we would expect to execute don't seem to run, so we need to explicitly enable the submit button in the event that it was not enabled until all of the fields were entered and the accept terms of use checkbox was clicked.</p>
<p>And that's it! I now have a PowerShell script that runs in seconds and logs me into the client's guest WiFi network.</p>
<p><img src="http://agileramblings.files.wordpress.com/2015/07/image_thumb2.png?w=244&amp;h=80" alt="image" title="image"></p>
<p>As a final task, I took the code in my Login-GuestWifi.ps1, converted it to a function and placed it in my ./profile.ps1 file that gets invoked any time a PowerShell session is started on my machine.</p>
<p>It should be noted that the UserName and Password, in my case, were not secured in any fashion other than being only physically stored on my machine in my scripts file. I never checked my credentials into source control and I had no need to put them anywhere else. If needed, I could secure them but that wasn't necessary. These are not domain credentials and are only giving people access to the guest WiFi network.</p>
<h3>Final Thoughts</h3>
<p>My goal with this post was to exposed you to the idea of using PowerShell to automate simple web-based tasks in Internet Explorer. I've recently been using PowerShell a lot and I've just been continuously impressed with how powerful it is. So go give it a try!</p>

	        </div>

            
            <section id="comments">
            <div id="disqus_thread">
                <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript" target="_blank" rel="noopener">comments powered by Disqus.</a></noscript>
            </div>
            </section>
            
		</div>
	</div>
<!--MAIN CONTENT ENDS-->

<!--SIDEBAR CONTENT STARTS-->
	<div class="SubpageBoxSubSm">
		<div class="SubpageBoxSubSmContent">
			
			

			<div class="ProfileImg">
				
				<a href="/bios/dave_white">
				
					<img src='https://www.gravatar.com/avatar/4b7708d2ae7f7bb866446e0459e3e156?s=200' />
				
				</a>
				
			</div>

			<BR clear="all">

			<h2><a href="/bios/dave_white">Dave White</a></h2>
			
			<a href="mailto:dmhwhite@gmail.com"><img class="ProfileIcon" src="/images/icon_email.png" border="0" alt="Email" title="Email"> Email</a><BR>
			
			
			<a href="http://agileramblings.com/" target="_blank"><img class="ProfileIcon" src="/images/icon_web.png" border="0" alt="Web" title="Web"> Web</a><BR>
			
			
			<a href="http://twitter.com/AgileRamblings" target="_blank"><img class="ProfileIcon" src="/images/icon_twitter.png" border="0" alt="Twitter" title="Twitter"> Twitter</a><BR>
			
			
			<a href="https://github.com/agileramblings" target="_blank"><img class="ProfileIcon" src="/images/icon_github.png" border="0" alt="GitHub" title="GitHub"> GitHub</a><br>
			
			
			<a href="https://www.linkedin.com/in/dave-white" target="_blank"><img class="ProfileIcon" src="/images/icon_linkedin.png" border="0" alt="LinkedIN" title="LinkedIN"> LinkedIn</a><br>
			
			
 			<a href="/feeds/dave_white.xml"><img class="ProfileIcon" src="/images/icon_subscribe.png" /> RSS</a>
			

			<hr />
			<h4>Looking for someone else?</h4>
			<p>You can find the rest of the Western Devs Crew <a href="/whoweare">here</a>.</p>
		</div>
	</div>
<!--SIDEBAR CONTENT ENDS-->


</div>
</center>
<!--PAGE CONTENT ENDS-->


<!--FOOTER STARTS-->
<center>
  <div class="FooterBarTxt">&copy; 2015 Western Devs. All Rights Reserved. Design by <a href="http://www.karenchudobiak.ca" target="_blank">Karen Chudobiak, Graphic Designer</a></div>
</center>
<!--FOOTER ENDS-->

<!-- NAV FOOTER STARTS -->
<div class="NavFooter">
  <a href="/posts" alt="Posts"><i class="fa fa-newspaper-o fa-2x"></i><span>Posts</span></a>
  <a href="/podcasts" alt="Podcasts"><i class="fa fa-volume-up fa-2x"></i><span>Podcasts</span></a>
  <a href="/whoweare" alt="About"><i class="fa fa-star fa-2x"></i><span>About</span></a>
  <a href="/whatwevedone" alt="What We've Done"><i class="fa fa-trophy fa-2x"></i><span>Work</span></a>
  <a href="/speaking" alt="Speaking"><i class="fa fa-comment-o fa-2x fa-flip-horizontal"></i><span>Speaking</span></a>
</div>
<!-- NAV FOOTER ENDS -->




</div>
<!--WRAPPER ENDS-->


<script>
  var disqus_shortname = 'westerndevs';
  
  var disqus_url = 'https://westerndevs.com/_/simple-powershell-automation-browser-based-tasks/'.replace(".com//", ".com/");
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
  
function shuffle(array) {
  var currentIndex = array.length, temporaryValue, randomIndex;

  // While there remain elements to shuffle...
  while (0 !== currentIndex) {

    // Pick a remaining element...
    randomIndex = Math.floor(Math.random() * currentIndex);
    currentIndex -= 1;

    // And swap it with the current element.
    temporaryValue = array[currentIndex];
    array[currentIndex] = array[randomIndex];
    array[randomIndex] = temporaryValue;
  }

  return array;
}

</script>


</body>

  
<!-- Google Analytics -->
<script type="text/javascript">
if (document.location.hostname.search("westerndevs.com") !== -1 || document.location.hostname.search("www.westerndevs.com") !== -1) {
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-37617956-2', 'auto');

ga('set', 'contentGroup1', 'dave_white');

ga('send', 'pageview');
}
</script>
<!-- End Google Analytics -->



</html>
