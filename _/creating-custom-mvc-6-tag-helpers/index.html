<!DOCTYPE html>
<html lang="en" xml:lang="en">

  <head>
  
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Creating custom MVC 6 Tag Helpers | Western Devs</title>
  <meta name="description" content="In the last few blog posts, I have spent some time covering the tag helpers that are built in to MVC 6. While the built in tag helpers cover a lot of functionality needed for many basic scenarios, you">
<meta property="og:type" content="article">
<meta property="og:title" content="Creating custom MVC 6 Tag Helpers">
<meta property="og:url" content="https://westerndevs.com/_/creating-custom-mvc-6-tag-helpers/index.html">
<meta property="og:site_name" content="Western Devs">
<meta property="og:description" content="In the last few blog posts, I have spent some time covering the tag helpers that are built in to MVC 6. While the built in tag helpers cover a lot of functionality needed for many basic scenarios, you">
<meta property="article:published_time" content="2015-06-23T00:09:05.000Z">
<meta property="article:modified_time" content="2024-03-20T22:46:43.877Z">
<meta property="article:author" content="Western Devs">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@westerndevs">

    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="title" content="WesternDevs">   
    <meta name="keywords" content="software development,software,asp.net,blog">
    <meta name="description" content="We're all west of somewhere">
    <meta name="copyright" content="WesternDevs">
    <meta name="revisit-after" content="15 days">
    <meta name="robots" content="all">
    <meta name="MSSmartTagsPreventParsing" content="true">
  
    <link rel="canonical" href="http://www.davepaquette.com/archive/2015/06/22/creating-custom-mvc-6-tag-helpers.aspx">
  
  
    <link rel="alternate" href="/feed.xml" title="Western Devs" type="application/atom+xml">
  
  
<link rel="stylesheet" href="/css/style.css">

      
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <script src="//code.jquery.com/jquery-1.11.3.min.js"></script>  
  <meta name="generator" content="Hexo 4.2.1"></head>

<body>

<!-- FIXED HEADER BECAUSE SCROLLING -->
<!--HEADER STARTS-->
<div class="WrapperHeader">
<div style="display:inline-block; text-align: center;">
<div class="Header">

  <div class="HeaderLogo">
    <a href="/"><img src="/images/header_logo_transparent.png" alt="WesternDevs" title="WesternDevs" border="0" style="width: 206px; height: 64px;" width="206" height="64"></a>
  </div>

  <div class="HeaderLinks">
      <a href="/posts" class="nav">POSTS</a>       
      <a href="/podcasts" class="nav">PODCASTS</a>       
      <a href="/whoweare" class="nav">ABOUT</a>  
      <a href="/whatwevedone" class="nav">WHAT WE'VE DONE</a>  
      <a href="/speaking" class="nav">SPEAKING</a>
      <div class="HeaderIcons">
        <a href="mailto:info@westerndevs.com"><img src="/images/icon_email.png" border="0" alt="Email" title="Email" height="26" width="26"></a>
        <a href="/feed.xml"><img src="/images/icon_subscribe.png" border="0" alt="Subscribe" title="Subscribe" height="26" width="27"></a>
        <a href="http://twitter.com/westerndevs" target="_blank"><img src="/images/icon_twitter.png" border="0" alt="Twitter" title="Twitter" height="26" width="27"></a>
        <a href="http://github.com/westerndevs" target="_blank"><img src="/images/icon_github.png" border="0" alt="GitHub" title="GitHub" height="26" width="27"></a>     
      </div>
  </div>
  
</div>
</div>
</div>
<!--HEADER ENDS-->    



<!--WRAPPER STARTS-->
<div class="Wrapper" style="">

<!--SUBHEAD STARTS-->
<div class="WrapperSubHeaderSubpage">
<center>
	<div class="SubHeader">
		<H1 class="title"><img class="icon" src="/images/icon_posts.png" alt="POST" title="POST" border="0"> POST</H1>
	</div>
</center>
</div>
<!--SUBHEAD ENDS-->

<!--PAGE CONTENT STARTS-->
<center>
<div class="WrapperContent">

<!--MAIN CONTENT STARTS-->
	<div class="SubpageBoxSubLrg">
		<div class="SubpageBoxSubLrgContent">
		    <div class='postTitle'>
  <div class="ListLrgDateBG">
    <div class="ListLrgDateMonth">JUN</div>
    <div class="ListLrgDateDay">23</div>
    <div class="ListLrgDateYear">2015</div>
  </div>
  <h2>Creating custom MVC 6 Tag Helpers</h2>
</div>

		    

<p class="TXTsm">ORIGINALLY POSTED TO: <a href="http://www.davepaquette.com/archive/2015/06/22/creating-custom-mvc-6-tag-helpers.aspx" target="_blank" rel="noopener" class='originalurl'>http://www.davepaquette.com/archive/2015/06/22/creating-custom-mvc-6-tag-helpers.aspx</a></p>



			<div id="mainPostContent">
	        <p>In the last few blog posts, I have spent some time covering the tag helpers that are built in to MVC 6. While the built in tag helpers cover a lot of functionality needed for many basic scenarios, you might also find it beneficial to create your tag helpers from time to time.</p>
<p>In this post, I will show how you can easily create a simple tag helper to generate a Bootstrap progress bar. <em>NOTE: Thank you to <a href="http://jameschambers.com/" target="_blank" rel="noopener">James Chambers</a> for giving me the idea to look at bootstrap components for ideas for custom tag helpers.</em></p>
<a id="more"></a>
<p>Based on the documentation for the bootstrap <a href="http://getbootstrap.com/components/#progress" target="_blank" rel="noopener">progress bar component</a>, we need to write the following HTML to render a simple progress bar:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"progress"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"progress-bar"</span> <span class="attr">role</span>=<span class="string">"progressbar"</span> <span class="attr">aria-valuenow</span>=<span class="string">"60"</span> <span class="attr">aria-valuemin</span>=<span class="string">"0"</span> <span class="attr">aria-valuemax</span>=<span class="string">"100"</span> <span class="attr">style</span>=<span class="string">"width: 60%;"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"sr-only"</span>&gt;</span>60% Complete<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>This is a little verbose and it can also be easy to forget some portion of the markup like the aria attributes or the role attribute. Using tag helpers, we can make the code easier to read and ensure that the HTML output is consistent everywhere we want to use a bootstrap progress bar.</p>
<h2>Choosing your syntax</h2>
<p>With tag helpers, you can choose to either create your own custom tag names or augment existing tags with special tag helper attributes. Examples of custom tags would be the <a href="http://www.davepaquette.com/archive/2015/05/05/web-optimization-development-and-production-in-asp-net-mvc6.aspx" target="_blank" rel="noopener">environment tag helper</a> and the <a href="http://www.davepaquette.com/archive/2015/06/03/mvc-6-cache-tag-helper.aspx" target="_blank" rel="noopener">cache tag helper</a>. Most of the other built in MVC 6 tag helpers target existing HTML tags. Take a look at the <a href="http://www.davepaquette.com/archive/2015/05/13/mvc6-input-tag-helper-deep-dive.aspx" target="_blank" rel="noopener">input tag helper</a> and the <a href="http://www.davepaquette.com/archive/2015/05/14/mvc6-validation-tag-helpers-deep-dive.aspx" target="_blank" rel="noopener">validation tag helper</a> for examples.</p>
<p>At this point, I'm not 100% sure when one is more appropriate than the other. Looking at the built in MVC 6 tag helpers, the only tag helpers that target new elements are those that don't really have a corresponding HTML element that would make sense. Mostly, I think it depends on what you want your cshtml code to look like and this will largely be a personal preference. In this example, I am going to choose to target the <code>&lt;div&gt;</code> tag but I could have also chosen to create a new <code>&lt;bs_progress_bar&gt;</code> tag. The same thing happens in the angularjs world. Developers in angularjs have the option to create declare directives that are used as attributes or as custom elements. Sometimes there is an obvious choice but often it comes down to personal preference.</p>
<p>So, what I want my markup to look like is this:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">bs-progress-value</span>=<span class="string">"@Model.CurrentProgress"</span></span></span><br><span class="line"><span class="tag">     <span class="attr">bs-progress-max</span>=<span class="string">"100"</span></span></span><br><span class="line"><span class="tag">     <span class="attr">bs-progress-min</span>=<span class="string">"0"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>Now all we need to do is create a tag helper turn this simplified markup into the more verbose markup needed to render a bootstrap progress bar.</p>
<h2>Creating a tag helper class</h2>
<p>Tag helpers are pretty simple constructs. They are classes that inherit from the base TagHelper class. In this class, you need to do a few things.</p>
<p>First, you need to specify a TargetElement attribute: this is what tells Razor which HTML tags / attributes to associate with this tag helper. In our case, we want to target any
element that has the bs-progress-value element.</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">TargetElement(<span class="meta-string">"div"</span>, Attributes = ProgressValueAttributeName)</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ProgressBarTagHelper</span> : <span class="title">TagHelper</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">const</span> <span class="keyword">string</span> ProgressValueAttributeName = <span class="string">"bs-progress-value"</span>;    </span><br><span class="line">    <span class="comment">//....</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The Attributes parameter for the TargetElement is a coma separated list of attributes that are _required _for this tag helper. I'm not making the bs-progress-min and bs-progress-max attributes required. Instead, I am going to give them a default of 0 and 100 respectively. This brings us to the next steps which is defining properties for any of the tag helper attributes. Define these as simple properties on the class and annotate them with an HtmlAttributeName attribute to specify the attribute name that will be used in markup.</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">TargetElement(<span class="meta-string">"div"</span>, Attributes = ProgressValueAttributeName)</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ProgressBarTagHelper</span> : <span class="title">TagHelper</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">const</span> <span class="keyword">string</span> ProgressValueAttributeName = <span class="string">"bs-progress-value"</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">const</span> <span class="keyword">string</span> ProgressMinAttributeName = <span class="string">"bs-progress-min"</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">const</span> <span class="keyword">string</span> ProgressMaxAttributeName = <span class="string">"bs-progress-max"</span>;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">HtmlAttributeName(ProgressValueAttributeName)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> ProgressValue &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">HtmlAttributeName(ProgressMinAttributeName)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> ProgressMin &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125; = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">HtmlAttributeName(ProgressMaxAttributeName)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> ProgressMax &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125; = <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>These attributes are strongly typed which means Razor will give you errors if someone tries to bind a string or a date to one of these int properties.</p>
<p>Finally, you need to override either the Process or the ProcessAsync method. In this example, the logic is simple and does not require any async work to happen so it is probably best to override the Process method. If the logic required making a request or processing a file, you would be better off overriding the ProcessAsync method.</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">TargetElement(<span class="meta-string">"div"</span>, Attributes = ProgressValueAttributeName)</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ProgressBarTagHelper</span> : <span class="title">TagHelper</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">const</span> <span class="keyword">string</span> ProgressValueAttributeName = <span class="string">"bs-progress-value"</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">const</span> <span class="keyword">string</span> ProgressMinAttributeName = <span class="string">"bs-progress-min"</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">const</span> <span class="keyword">string</span> ProgressMaxAttributeName = <span class="string">"bs-progress-max"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> An expression to be evaluated against the current model.</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    [<span class="meta">HtmlAttributeName(ProgressValueAttributeName)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> ProgressValue &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">HtmlAttributeName(ProgressMinAttributeName)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> ProgressMin &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125; = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">HtmlAttributeName(ProgressMaxAttributeName)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> ProgressMax &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125; = <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">Process</span>(<span class="params">TagHelperContext context, TagHelperOutput output</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">var</span> progressTotal = ProgressMax - ProgressMin;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> progressPercentage = Math.Round(((<span class="keyword">decimal</span>) (ProgressValue - ProgressMin) / (<span class="keyword">decimal</span>) progressTotal) * <span class="number">100</span>, <span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">string</span> progressBarContent =</span><br><span class="line">            <span class="keyword">string</span>.Format(</span><br><span class="line"><span class="string">@"&lt;div class='progress-bar' role='progressbar' aria-valuenow='&#123;0&#125;' aria-valuemin='&#123;1&#125;' aria-valuemax='&#123;2&#125;' style='width: &#123;3&#125;%;'&gt;</span></span><br><span class="line"><span class="string">&lt;span class='sr-only'&gt;&#123;3&#125;% Complete&lt;/span&gt;</span></span><br><span class="line"><span class="string">&lt;/div&gt;"</span>, ProgressValue, ProgressMin, ProgressMax, progressPercentage);</span><br><span class="line"></span><br><span class="line">        output.Content.Append(progressBarContent);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">string</span> classValue;</span><br><span class="line">        <span class="keyword">if</span> (output.Attributes.ContainsKey(<span class="string">"class"</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            classValue = <span class="keyword">string</span>.Format(<span class="string">"&#123;0&#125; &#123;1&#125;"</span>, output.Attributes[<span class="string">"class"</span>], <span class="string">"progress"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            classValue = <span class="string">"progress"</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        output.Attributes[<span class="string">"class"</span>] = classValue;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The Process method has 2 parameters: a TagHelperContext and a TagHelperOutput. In this simple example, we don't need to worry about the TagHelperContext. It contains information about the input element such as the attributes that were specified there and a unique ID that might be needed if multiple instances of the tag helpers were used on a single page. The TagHelperOutput is where we need to specify the HTML that will be output by this tag helper. We start by doing some basic math to calculate the percentage complete of the progress bar. Next, I used a string.Format to build the inner HTML for the bootstrap progress bar with the specified min, max, value and calculated percentages. I add this to the contents of the output by calling output.Content.Append. The last step is to add class=&quot;progress&quot; to the outer div. I can't just add the attribute though because there is a chance that the developer has already specified another class for this div (it is possible that we want the output to be <em>class=&quot;green progress&quot;</em>.</p>
<p>If you need to build more complicated HTML in the content, you should consider using the <a href="https://github.com/aspnet/Mvc/blob/master/src/Microsoft.AspNetCore.Mvc.ViewFeatures/Rendering/TagBuilder.cs" target="_blank" rel="noopener">TagBuilder class</a>. If a tag helper grows too complex, you might want to consider creating a View Component instead.</p>
<p>Finally, we should add some argument checking to make sure that the Min / Max and Value properties are appropriate. For example, the ProgressMin value should be less than the ProgressMax value. We can throw argument exceptions to clearly indicate errors. Here is the finally implementation of the ProgressBarTagHelper:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">TargetElement(<span class="meta-string">"div"</span>, Attributes = ProgressValueAttributeName)</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ProgressBarTagHelper</span> : <span class="title">TagHelper</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">const</span> <span class="keyword">string</span> ProgressValueAttributeName = <span class="string">"bs-progress-value"</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">const</span> <span class="keyword">string</span> ProgressMinAttributeName = <span class="string">"bs-progress-min"</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">const</span> <span class="keyword">string</span> ProgressMaxAttributeName = <span class="string">"bs-progress-max"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> An expression to be evaluated against the current model.</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    [<span class="meta">HtmlAttributeName(ProgressValueAttributeName)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> ProgressValue &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">HtmlAttributeName(ProgressMinAttributeName)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> ProgressMin &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125; = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">HtmlAttributeName(ProgressMaxAttributeName)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> ProgressMax &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125; = <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">Process</span>(<span class="params">TagHelperContext context, TagHelperOutput output</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span> (ProgressMin &gt;= ProgressMax)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="keyword">string</span>.Format(<span class="string">"&#123;0&#125; must be less than &#123;1&#125;"</span>, ProgressMinAttributeName, ProgressMaxAttributeName));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (ProgressValue &gt; ProgressMax || ProgressValue &lt; ProgressMin)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentOutOfRangeException(<span class="keyword">string</span>.Format(<span class="string">"&#123;0&#125; must be within the range of &#123;1&#125; and &#123;2&#125;"</span>, ProgressValueAttributeName, ProgressMinAttributeName, ProgressMaxAttributeName));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> progressTotal = ProgressMax - ProgressMin;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> progressPercentage = Math.Round(((<span class="keyword">decimal</span>) (ProgressValue - ProgressMin) / (<span class="keyword">decimal</span>) progressTotal) * <span class="number">100</span>, <span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">string</span> progressBarContent =</span><br><span class="line">            <span class="keyword">string</span>.Format(</span><br><span class="line"><span class="string">@"&lt;div class='progress-bar' role='progressbar' aria-valuenow='&#123;0&#125;' aria-valuemin='&#123;1&#125;' aria-valuemax='&#123;2&#125;' style='width: &#123;3&#125;%;'&gt;</span></span><br><span class="line"><span class="string">&lt;span class='sr-only'&gt;&#123;3&#125;% Complete&lt;/span&gt;</span></span><br><span class="line"><span class="string">&lt;/div&gt;"</span>, ProgressValue, ProgressMin, ProgressMax, progressPercentage);</span><br><span class="line"></span><br><span class="line">        output.Content.Append(progressBarContent);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">string</span> classValue;</span><br><span class="line">        <span class="keyword">if</span> (output.Attributes.ContainsKey(<span class="string">"class"</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            classValue = <span class="keyword">string</span>.Format(<span class="string">"&#123;0&#125; &#123;1&#125;"</span>, output.Attributes[<span class="string">"class"</span>], <span class="string">"progress"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            classValue = <span class="string">"progress"</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        output.Attributes[<span class="string">"class"</span>] = classValue;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">base</span>.Process(context, output);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2>Referencing the custom Tag Helper</h2>
<p>Before we can start using our custom tag helper, we need to add a reference to the tag helpers in the current assembly using the @addTagHelper Razor command. We can do this in individual Razor files or we can add it the _GlobalImports.cshtml file so it is applied everywhere:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@<span class="keyword">using</span> WebApplication3</span><br><span class="line">@<span class="keyword">using</span> WebApplication3.Models</span><br><span class="line">@<span class="keyword">using</span> Microsoft.Framework.OptionsModel</span><br><span class="line">@<span class="keyword">using</span> Microsoft.AspNet.Identity</span><br><span class="line">@addTagHelper <span class="string">"*, Microsoft.AspNet.Mvc.TagHelpers"</span></span><br><span class="line">@addTagHelper <span class="string">"*, WebApplication3"</span>  </span><br></pre></td></tr></table></figure>
<p>Now we can reference the tag helper in any of our Razor views. Here is an example binding the PercentComplete property from the model to the ProgressValue property of the tag helper.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">bs-progress-value</span>=<span class="string">"@Model.PercentComplete"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>Here is another example that would display progress for a 5 step process:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">bs-progress-min</span>=<span class="string">"1"</span></span></span><br><span class="line"><span class="tag">     <span class="attr">bs-progress-max</span>=<span class="string">"5"</span></span></span><br><span class="line"><span class="tag">     <span class="attr">bs-progress-value</span>=<span class="string">"@Model.CurrentStep"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3>Unit Testing</h3>
<p>Tag Helpers are easy enough to unit test and I would definitely recommend that you do test them. Take a look at <a href="https://github.com/aspnet/Mvc/tree/dev/test/Microsoft.AspNetCore.Mvc.Test" target="_blank" rel="noopener">these examples</a> in the MVC 6 repo for reference.</p>
<h2>Conclusion</h2>
<p>By creating this simple tag helper, we are able to greatly simplify the Razor code required to create a bootstrap progress bar with a value from the our model. As a result, our Razor view is easier to understand and we can ensure a consistent output for all progress bars in our app. If we needed to change the way we rendered progress bars, we would only need to change the code in one place. This is of course a relatively simple example but I think it shows the potential for tag helpers in MVC 6.</p>

	        </div>

            
            <section id="comments">
            <div id="disqus_thread">
                <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript" target="_blank" rel="noopener">comments powered by Disqus.</a></noscript>
            </div>
            </section>
            
		</div>
	</div>
<!--MAIN CONTENT ENDS-->

<!--SIDEBAR CONTENT STARTS-->
	<div class="SubpageBoxSubSm">
		<div class="SubpageBoxSubSmContent">
			
			

			<div class="ProfileImg">
				
				<a href="/bios/dave_paquette">
				
					<img src='/images/avatars/DavePaquette_241x241.jpg' />
				
				</a>
				
			</div>

			<BR clear="all">

			<h2><a href="/bios/dave_paquette">Dave Paquette</a></h2>
			
			<a href="mailto:contactme@davepaquette.com"><img class="ProfileIcon" src="/images/icon_email.png" border="0" alt="Email" title="Email"> Email</a><BR>
			
			
			<a href="http://www.davepaquette.com/" target="_blank"><img class="ProfileIcon" src="/images/icon_web.png" border="0" alt="Web" title="Web"> Web</a><BR>
			
			
			<a href="http://twitter.com/Dave_Paquette" target="_blank"><img class="ProfileIcon" src="/images/icon_twitter.png" border="0" alt="Twitter" title="Twitter"> Twitter</a><BR>
			
			
			<a href="https://github.com/dpaquette" target="_blank"><img class="ProfileIcon" src="/images/icon_github.png" border="0" alt="GitHub" title="GitHub"> GitHub</a><br>
			
			
			
 			<a href="/feeds/dave_paquette.xml"><img class="ProfileIcon" src="/images/icon_subscribe.png" /> RSS</a>
			

			<hr />
			<h4>Looking for someone else?</h4>
			<p>You can find the rest of the Western Devs Crew <a href="/whoweare">here</a>.</p>
		</div>
	</div>
<!--SIDEBAR CONTENT ENDS-->


</div>
</center>
<!--PAGE CONTENT ENDS-->


<!--FOOTER STARTS-->
<center>
  <div class="FooterBarTxt">&copy; 2015 Western Devs. All Rights Reserved. Design by <a href="http://www.karenchudobiak.ca" target="_blank">Karen Chudobiak, Graphic Designer</a></div>
</center>
<!--FOOTER ENDS-->

<!-- NAV FOOTER STARTS -->
<div class="NavFooter">
  <a href="/posts" alt="Posts"><i class="fa fa-newspaper-o fa-2x"></i><span>Posts</span></a>
  <a href="/podcasts" alt="Podcasts"><i class="fa fa-volume-up fa-2x"></i><span>Podcasts</span></a>
  <a href="/whoweare" alt="About"><i class="fa fa-star fa-2x"></i><span>About</span></a>
  <a href="/whatwevedone" alt="What We've Done"><i class="fa fa-trophy fa-2x"></i><span>Work</span></a>
  <a href="/speaking" alt="Speaking"><i class="fa fa-comment-o fa-2x fa-flip-horizontal"></i><span>Speaking</span></a>
</div>
<!-- NAV FOOTER ENDS -->




</div>
<!--WRAPPER ENDS-->


<script>
  var disqus_shortname = 'westerndevs';
  
  var disqus_url = 'https://westerndevs.com/_/creating-custom-mvc-6-tag-helpers/'.replace(".com//", ".com/");
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
  
function shuffle(array) {
  var currentIndex = array.length, temporaryValue, randomIndex;

  // While there remain elements to shuffle...
  while (0 !== currentIndex) {

    // Pick a remaining element...
    randomIndex = Math.floor(Math.random() * currentIndex);
    currentIndex -= 1;

    // And swap it with the current element.
    temporaryValue = array[currentIndex];
    array[currentIndex] = array[randomIndex];
    array[randomIndex] = temporaryValue;
  }

  return array;
}

</script>


</body>

  
<!-- Google Analytics -->
<script type="text/javascript">
if (document.location.hostname.search("westerndevs.com") !== -1 || document.location.hostname.search("www.westerndevs.com") !== -1) {
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-37617956-2', 'auto');

ga('set', 'contentGroup1', 'dave_paquette');

ga('send', 'pageview');
}
</script>
<!-- End Google Analytics -->



</html>
