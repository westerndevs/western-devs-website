<!DOCTYPE html>
<html lang="en" xml:lang="en">

  <head>
  
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Running Kubernetes on Azure Container Services | Western Devs</title>
  <meta name="description" content="Docker is cool and all but shipping containers to production has a lot of added challenges. Scaling, deploying, rolling deployments, storage,... the list of challenges goes on and on. An orchestration">
<meta property="og:type" content="article">
<meta property="og:title" content="Running Kubernetes on Azure Container Services">
<meta property="og:url" content="https://westerndevs.com/development/Kubernetes_on_azure/index.html">
<meta property="og:site_name" content="Western Devs">
<meta property="og:description" content="Docker is cool and all but shipping containers to production has a lot of added challenges. Scaling, deploying, rolling deployments, storage,... the list of challenges goes on and on. An orchestration">
<meta property="og:image" content="http://i.imgur.com/JjmmFvg.png">
<meta property="article:published_time" content="2017-06-07T23:36:36.000Z">
<meta property="article:modified_time" content="2020-12-04T02:04:56.032Z">
<meta property="article:author" content="Western Devs">
<meta property="article:tag" content="c#">
<meta property="article:tag" content="kuberntes">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://i.imgur.com/JjmmFvg.png">
<meta name="twitter:creator" content="@westerndevs">

    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="title" content="WesternDevs">   
    <meta name="keywords" content="software development,software,asp.net,blog">
    <meta name="description" content="We're all west of somewhere">
    <meta name="copyright" content="WesternDevs">
    <meta name="revisit-after" content="15 days">
    <meta name="robots" content="all">
    <meta name="MSSmartTagsPreventParsing" content="true">
  
    <link rel="alternate" href="/feed.xml" title="Western Devs" type="application/atom+xml">
  
  
<link rel="stylesheet" href="/css/style.css">

      
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <script src="//code.jquery.com/jquery-1.11.3.min.js"></script>  
  <meta name="generator" content="Hexo 4.2.0"></head>

<body>

<!-- FIXED HEADER BECAUSE SCROLLING -->
<!--HEADER STARTS-->
<div class="WrapperHeader">
<div style="display:inline-block; text-align: center;">
<div class="Header">

  <div class="HeaderLogo">
    <a href="/"><img src="/images/header_logo_transparent.png" alt="WesternDevs" title="WesternDevs" border="0" style="width: 206px; height: 64px;" width="206" height="64"></a>
  </div>

  <div class="HeaderLinks">
      <a href="/posts" class="nav">POSTS</a>       
      <a href="/podcasts" class="nav">PODCASTS</a>       
      <a href="/whoweare" class="nav">ABOUT</a>  
      <a href="/whatwevedone" class="nav">WHAT WE'VE DONE</a>  
      <a href="/speaking" class="nav">SPEAKING</a>
      <div class="HeaderIcons">
        <a href="mailto:info@westerndevs.com"><img src="/images/icon_email.png" border="0" alt="Email" title="Email" height="26" width="26"></a>
        <a href="/feed.xml"><img src="/images/icon_subscribe.png" border="0" alt="Subscribe" title="Subscribe" height="26" width="27"></a>
        <a href="http://twitter.com/westerndevs" target="_blank"><img src="/images/icon_twitter.png" border="0" alt="Twitter" title="Twitter" height="26" width="27"></a>
        <a href="http://github.com/westerndevs" target="_blank"><img src="/images/icon_github.png" border="0" alt="GitHub" title="GitHub" height="26" width="27"></a>     
      </div>
  </div>
  
</div>
</div>
</div>
<!--HEADER ENDS-->    



<!--WRAPPER STARTS-->
<div class="Wrapper" style="">

<!--SUBHEAD STARTS-->
<div class="WrapperSubHeaderSubpage">
<center>
	<div class="SubHeader">
		<H1 class="title"><img class="icon" src="/images/icon_posts.png" alt="POST" title="POST" border="0"> POST</H1>
	</div>
</center>
</div>
<!--SUBHEAD ENDS-->

<!--PAGE CONTENT STARTS-->
<center>
<div class="WrapperContent">

<!--MAIN CONTENT STARTS-->
	<div class="SubpageBoxSubLrg">
		<div class="SubpageBoxSubLrgContent">
		    <div class='postTitle'>
  <div class="ListLrgDateBG">
    <div class="ListLrgDateMonth">JUN</div>
    <div class="ListLrgDateDay">7</div>
    <div class="ListLrgDateYear">2017</div>
  </div>
  <h2>Running Kubernetes on Azure Container Services</h2>
</div>

		    

			<div id="mainPostContent">
	        <p>This blog post will walk through how to set up a small Kubernetes cluster on Azure Container Services, manage it with Kubernetes and do a rolling deployment. You may think that sounds like kind of a lot. You're not wrong. Let's dig right in.</p>
<p><em>Note:</em> If you're a visual or auditory learner then check out the channel 9 video version of this blog post.</p>
<p>We're going to avoid using the point and click portal for this entire workflow, instead we'll lean on the really fantastic Azure command line. This tool can be installed locally or you can use the version built into the portal.</p>
<p><img src="http://i.imgur.com/JjmmFvg.png" alt="Azure CLI in Portal"></p>
<p>Using the commandline is great for this sort of thing because there are quite a few moving parts and we can use variables to keep track of them. Let's start with all the variables we'll need, we'll divide them up into two sets.</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">RESOURCE_GROUP=kubernetes</span><br><span class="line">REGION=australiasoutheast</span><br><span class="line">DNS_PREFIX=prdc2017</span><br><span class="line">CLUSTER_NAME=prdc2017</span><br></pre></td></tr></table></figure>
<p>The first set of variables here are needed to stand up the resource group and Azure Container Service. The resource group is called <code>kubernetes</code> which is great for my experiments but not so good for your production system. You'll likely want a better name, or, if you're still governed by legacy IT practices you'll want a name like <code>IL004AB1</code> which encodes some obscure bits of data. Next up is the region in which everything should be created. I chose Australia South-East because it was the first region to have a bug fix I needed rolled out to it. Normally I'd save myself precious hundreds of miliseconds by using a closer region. Finally the DNS_PREFIX and CLUSTER_NAME are used to name items in the ACS deployment.</p>
<p>Next variables are related to the Azure container registry frequently called ACR.</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">REGISTRY</span>=prdc2017registry</span><br><span class="line"></span><br><span class="line"><span class="attr">DOCKER_REGISTRY_SERVER</span>=<span class="variable">$REGISTY</span>.azurecr.io</span><br><span class="line"><span class="attr">DOCKER_USER_NAME</span>=<span class="variable">$REGISTRY</span></span><br><span class="line"><span class="attr">DOCKER_PASSWORD</span>=yAZxyNVN8yIs5uln9yNQ</span><br><span class="line"><span class="attr">DOCKER_EMAIL</span>=stimms@gmail.com</span><br></pre></td></tr></table></figure>
<p>Here we define the name of the registry, the URL, and some login credentials for it.</p>
<p>With the variables all defined we can move on to actually doing things. First off let's create a resource group to hold the twenty or so items which are generated by the default ACS ARM template.</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">az<span class="built_in"> group </span>create --name <span class="variable">$RESOURCE_GROUP</span> --location <span class="variable">$REGION</span></span><br></pre></td></tr></table></figure>
<p>This command takes only a few seconds. Next up we need to create the cluster. To create a Linux based cluster we'd run</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">az acs create <span class="attribute">--orchestrator-type</span>=kubernetes --resource-group <span class="variable">$RESOURCE_GROUP</span> <span class="attribute">--name</span>=<span class="variable">$CLUSTER_NAME</span> <span class="attribute">--dns-prefix</span>=<span class="variable">$DNS_PREFIX</span> --generate-ssh-keys</span><br></pre></td></tr></table></figure>
<p>Whereas a Windows cluster would vary only slightly and look like:</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">az acs create <span class="attribute">--orchestrator-type</span>=kubernetes --resource-group <span class="variable">$RESOURCE_GROUP</span> <span class="attribute">--name</span>=<span class="variable">$CLUSTER_NAME</span> <span class="attribute">--dns-prefix</span>=<span class="variable">$DNS_PREFIX</span> --generate-ssh-keys --windows --admin-password <span class="variable">$DOCKER_PASSWORD</span></span><br></pre></td></tr></table></figure>
<p>For the purposes of this article we'll focus on a Windows cluster. You can mix the two in a cluster but that's a bit of an advanced topic. Running this command takes quite some time, typically on the order of 15-20 minutes. However, the command is doing quite a lot: provisioning servers, IP addresses, storage, installing kubernetes,...</p>
<p>With the cluster up and running we can move onto building the registry (you could actually do them both at the same time, there is no dependency between them).</p>
<figure class="highlight dsconfig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#create a registry</span></span><br><span class="line"><span class="string">az </span><span class="string">acr </span><span class="string">create </span><span class="built_in">--name</span> $<span class="string">REGISTRY </span><span class="built_in">--resource-group</span> $<span class="string">RESOURCE_GROUP </span><span class="built_in">--location</span> $<span class="string">REGION </span><span class="built_in">--sku</span> <span class="string">Basic</span></span><br><span class="line"><span class="string">#</span><span class="string">assign </span>a <span class="string">service </span><span class="string">principal</span></span><br><span class="line"><span class="string">az </span><span class="string">ad </span><span class="string">sp </span><span class="built_in">create-for-rbac</span> <span class="built_in">--scopes</span> /<span class="string">subscriptions/</span><span class="string">5c642474-9eb9-</span><span class="string">43d8-8bfa-</span><span class="string">89df25418f39/</span><span class="string">resourcegroups/</span>$<span class="string">RESOURCE_GROUP/</span><span class="string">providers/</span><span class="string">Microsoft.</span><span class="string">ContainerRegistry/</span><span class="string">registries/</span>$<span class="string">REGISTRY </span><span class="built_in">--role</span> <span class="string">Owner </span><span class="built_in">--password</span> $<span class="string">DOCKER_PASSWORD</span></span><br><span class="line"><span class="string">az </span><span class="string">acr </span><span class="string">update </span>-n $<span class="string">REGISTRY </span><span class="built_in">--admin-enabled</span> <span class="string">true</span></span><br></pre></td></tr></table></figure>
<p>The first line creates the registry and the second sets up some credentials for it. Finally we enable admin logins.</p>
<p>Of course we'd really like our Kubernetes cluster to be able to pull images from the registry so we need to give Kubernetes an idea of how to do that.</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">az</span> acr credential show -n <span class="variable">$REGISTRY</span></span><br></pre></td></tr></table></figure>
<p>This command will dump out the credentials for the admin user. Notice that there are two passwords, either of them should work.</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl create<span class="built_in"> secret </span>docker-registry <span class="variable">$REGISTRY</span> <span class="attribute">--docker-server</span>=https://$DOCKER_REGISTRY_SERVER <span class="attribute">--docker-username</span>=<span class="variable">$REGISTRY</span> <span class="attribute">--docker-password</span>=<span class="string">"u+=+p==/x+E7/b=PG/D=RIVBMo=hQ/AJ"</span> <span class="attribute">--docker-email</span>=<span class="variable">$DOCKER_EMAIL</span></span><br></pre></td></tr></table></figure>
<p>The password is the one taken from the previous step, everything else from our variables at the start. This gives Kubernetes the credentials but we still need to instruct it to make use of them as the default. This can be done by editing one of the configuration ymls in Kubernetes.</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl <span class="builtin-name">get</span> serviceaccounts<span class="built_in"> default </span>-o yaml &gt; ./sa.yaml</span><br></pre></td></tr></table></figure>
<p>Regreives the YML for service accounts. In there two changes are required: first removing the resource version by deleting <code>resourceVersion: &quot;243024&quot;</code>. Next the credentials need to be specified by adding</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">imagePullSecrets:</span></span><br><span class="line">- <span class="string">name:</span> prdc2017registry</span><br></pre></td></tr></table></figure>
<p>This can now be sent back to Kubernetes</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl replace serviceaccounts<span class="built_in"> default </span>-f ./sa.yaml</span><br></pre></td></tr></table></figure>
<p>This interaction can also be done in the Kubernetes UI which can be accessed by running</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">kubectl proxy</span></span><br></pre></td></tr></table></figure>
<p>We've got everything set up on the cluster now and can start using it in earnest.</p>
<h2>Deploying to the Cluster</h2>
<p>First step is to build a container to use. I'm pretty big into ASP.NET Core so my first stop was to create a new project in Visual Studio and then drop to the command line for packaging. There is probably some way to push containers from Visual Studio using a right click but I'd rather learn it the command line way.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dotnet <span class="keyword">restore</span></span><br><span class="line"><span class="keyword">dotnet</span> publish -c <span class="keyword">Release</span> -o <span class="keyword">out</span></span><br><span class="line">docker <span class="keyword">build</span> -t dockerproject .</span><br></pre></td></tr></table></figure>
<p>If all goes well these commands in conjunciton with a simple Dockerfile should build a functional container. I used this docker file</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> microsoft/dotnet:<span class="number">1.1</span>.<span class="number">2</span>-runtime-nanoserver</span><br><span class="line"><span class="keyword">WORKDIR</span><span class="bash"> /dockerProject</span></span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> out .</span></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">5000</span></span><br><span class="line"><span class="keyword">ENTRYPOINT</span><span class="bash"> [<span class="string">"dotnet"</span>, <span class="string">"dockerProject.dll"</span>]</span></span><br></pre></td></tr></table></figure>
<p>This container can now make its way to our registry like so</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker login <span class="variable">$DOCKER_REGISTRY_SERVER</span> -u <span class="variable">$REGISTRY</span> -<span class="selector-tag">p</span> <span class="string">"u+=+p==/x+E7/b=PG/D=RIVBMo=hQ/AJ"</span></span><br><span class="line">docker tag dockerproject prdc2017registry<span class="selector-class">.azurecr</span>.io/dockerproject:v1</span><br><span class="line">docker push prdc2017registry<span class="selector-class">.azurecr</span>.io/dockerproject:v1</span><br></pre></td></tr></table></figure>
<p>This should upload all the layers to the registry. I don't know about you but I'm getting excited to see this thing in action.</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl <span class="built_in">run</span> dockerproject <span class="comment">--image prdc2017registry.azurecr.io/dockerproject:v1</span></span><br></pre></td></tr></table></figure>
<p>A bit anti-climactically this is all that is needed to trigger Kubernetes to run the container. Logging into the UI should show the container deployed to a single pod. If we'd like to scale it all that is needed is to increase the replicas in the UI or run</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl scale <span class="attribute">--replicas</span>=3 rc/dockerproject</span><br></pre></td></tr></table></figure>
<p>This will bring up two additional replicas so the total is three. Our final step is to expose the service port externally so that we can hit it from a web browser. Exposing a port of Kubernetes works differently depending on what service is being used to host your cluster. On Azure it makes use of the Azure load balancer.</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl expose deployments dockerproject <span class="attribute">--port</span>=5000 <span class="attribute">--type</span>=LoadBalancer</span><br></pre></td></tr></table></figure>
<p>This command does take about two minutes to run and you can check on the progress by running</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl <span class="builtin-name">get</span> svc</span><br></pre></td></tr></table></figure>
<p>With that we've created a cluster and deployed a container to it.</p>
<p>##Bonus: Rolling Deployment</p>
<p>Not much point to having a cluster if you can't do a zero downtime rolling deployment, right? Let's do it!</p>
<p>You'll need to push a new version of your container up to the registry. Let's call it v2.</p>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">docker</span> tag dockerproject prdc2017registry.azurecr.io/dockerproject:<span class="built_in">v2</span></span><br><span class="line"><span class="symbol">docker</span> <span class="keyword">push </span>prdc2017registry.azurecr.io/dockerproject:<span class="built_in">v2</span></span><br></pre></td></tr></table></figure>
<p>Now we can ask Kubernetes to please deploy it</p>
<figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl <span class="keyword">set</span> image <span class="comment">deployments</span>/dockerproject prdc2017registry.azurecr.io/<span class="comment">dockerproject:v2</span></span><br></pre></td></tr></table></figure>
<p>That's it! Now you can just watch in the UI as new pods are stood up, traffic rerouted and the old pods decomissioned.</p>
<h2>Conclusion</h2>
<p>It is a credit to the work of mnay thousands of people that it is so simple to set up an entire cluster and push an image to it forget that we can do zero downtime deployments. A cluster like this is a bit expensive to run so you have to be serious about getting good use out of it. Deploy early and deploy often. I'm stoked about containers and orchestration - I hope you are too!</p>
<p>Oh, and don't forget to tear down you're cluster when you're done playing.</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">az<span class="built_in"> group </span>delete --name <span class="variable">$RESOURCE_GROUP</span></span><br></pre></td></tr></table></figure>
	        </div>

            
            <section id="comments">
            <div id="disqus_thread">
                <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript" target="_blank" rel="noopener">comments powered by Disqus.</a></noscript>
            </div>
            </section>
            
		</div>
	</div>
<!--MAIN CONTENT ENDS-->

<!--SIDEBAR CONTENT STARTS-->
	<div class="SubpageBoxSubSm">
		<div class="SubpageBoxSubSmContent">
			
			

			<div class="ProfileImg">
				
				<a href="/bios/simon_timms">
				
					<img src='/images/avatars/simon.jpg' />
				
				</a>
				
			</div>

			<BR clear="all">

			<h2><a href="/bios/simon_timms">Simon Timms</a></h2>
			
			<a href="mailto:stimms@gmail.com"><img class="ProfileIcon" src="/images/icon_email.png" border="0" alt="Email" title="Email"> Email</a><BR>
			
			
			<a href="http://blog.simontimms.com/" target="_blank"><img class="ProfileIcon" src="/images/icon_web.png" border="0" alt="Web" title="Web"> Web</a><BR>
			
			
			<a href="http://twitter.com/stimms" target="_blank"><img class="ProfileIcon" src="/images/icon_twitter.png" border="0" alt="Twitter" title="Twitter"> Twitter</a><BR>
			
			
			<a href="https://github.com/stimms" target="_blank"><img class="ProfileIcon" src="/images/icon_github.png" border="0" alt="GitHub" title="GitHub"> GitHub</a><br>
			
			
			
 			<a href="/feeds/simon_timms.xml"><img class="ProfileIcon" src="/images/icon_subscribe.png" /> RSS</a>
			

			<hr />
			<h4>Looking for someone else?</h4>
			<p>You can find the rest of the Western Devs Crew <a href="/whoweare">here</a>.</p>
		</div>
	</div>
<!--SIDEBAR CONTENT ENDS-->


</div>
</center>
<!--PAGE CONTENT ENDS-->


<!--FOOTER STARTS-->
<center>
  <div class="FooterBarTxt">&copy; 2015 Western Devs. All Rights Reserved. Design by <a href="http://www.karenchudobiak.ca" target="_blank">Karen Chudobiak, Graphic Designer</a></div>
</center>
<!--FOOTER ENDS-->

<!-- NAV FOOTER STARTS -->
<div class="NavFooter">
  <a href="/posts" alt="Posts"><i class="fa fa-newspaper-o fa-2x"></i><span>Posts</span></a>
  <a href="/podcasts" alt="Podcasts"><i class="fa fa-volume-up fa-2x"></i><span>Podcasts</span></a>
  <a href="/whoweare" alt="About"><i class="fa fa-star fa-2x"></i><span>About</span></a>
  <a href="/whatwevedone" alt="What We've Done"><i class="fa fa-trophy fa-2x"></i><span>Work</span></a>
  <a href="/speaking" alt="Speaking"><i class="fa fa-comment-o fa-2x fa-flip-horizontal"></i><span>Speaking</span></a>
</div>
<!-- NAV FOOTER ENDS -->




</div>
<!--WRAPPER ENDS-->


<script>
  var disqus_shortname = 'westerndevs';
  
  var disqus_url = 'https://westerndevs.com/development/Kubernetes_on_azure/'.replace(".com//", ".com/");
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
  
function shuffle(array) {
  var currentIndex = array.length, temporaryValue, randomIndex;

  // While there remain elements to shuffle...
  while (0 !== currentIndex) {

    // Pick a remaining element...
    randomIndex = Math.floor(Math.random() * currentIndex);
    currentIndex -= 1;

    // And swap it with the current element.
    temporaryValue = array[currentIndex];
    array[currentIndex] = array[randomIndex];
    array[randomIndex] = temporaryValue;
  }

  return array;
}

</script>


</body>

  
<!-- Google Analytics -->
<script type="text/javascript">
if (document.location.hostname.search("westerndevs.com") !== -1 || document.location.hostname.search("www.westerndevs.com") !== -1) {
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-37617956-2', 'auto');

ga('set', 'contentGroup1', 'simon_timms');

ga('send', 'pageview');
}
</script>
<!-- End Google Analytics -->



</html>
