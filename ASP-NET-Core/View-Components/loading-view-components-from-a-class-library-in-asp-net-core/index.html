<!DOCTYPE html>
<html lang="en" xml:lang="en">

  <head>
  
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Loading View Components from a Class Library in ASP.NET Core MVC | Western Devs</title>
  <meta name="description" content="In today&#39;s post we take a look at how view components can be implemented in a separate class library and shared across multiple web applications.">
<meta property="og:type" content="article">
<meta property="og:title" content="Loading View Components from a Class Library in ASP.NET Core MVC">
<meta property="og:url" content="https://westerndevs.com/ASP-NET-Core/View-Components/loading-view-components-from-a-class-library-in-asp-net-core/index.html">
<meta property="og:site_name" content="Western Devs">
<meta property="og:description" content="In today&#39;s post we take a look at how view components can be implemented in a separate class library and shared across multiple web applications.">
<meta property="og:image" content="http://www.davepaquette.com/images/external_view_components/create_new_class_library.png">
<meta property="article:published_time" content="2016-07-16T12:36:36.000Z">
<meta property="article:modified_time" content="2024-08-14T13:47:37.578Z">
<meta property="article:author" content="Western Devs">
<meta property="article:tag" content="View Components">
<meta property="article:tag" content="ASP.NET Core">
<meta property="article:tag" content="MVC">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://www.davepaquette.com/images/external_view_components/create_new_class_library.png">
<meta name="twitter:creator" content="@westerndevs">

    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="title" content="WesternDevs">   
    <meta name="keywords" content="software development,software,asp.net,blog">
    <meta name="description" content="We're all west of somewhere">
    <meta name="copyright" content="WesternDevs">
    <meta name="revisit-after" content="15 days">
    <meta name="robots" content="all">
    <meta name="MSSmartTagsPreventParsing" content="true">
  
    <link rel="canonical" href="http://www.davepaquette.com/archive/2016/07/16/loading-view-components-from-a-class-library-in-asp-net-core.aspx">
  
  
    <link rel="alternate" href="/feed.xml" title="Western Devs" type="application/atom+xml">
  
  
<link rel="stylesheet" href="/css/style.css">

      
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <script src="//code.jquery.com/jquery-1.11.3.min.js"></script>  
  <meta name="generator" content="Hexo 4.2.1"></head>

<body>

<!-- FIXED HEADER BECAUSE SCROLLING -->
<!--HEADER STARTS-->
<div class="WrapperHeader">
<div style="display:inline-block; text-align: center;">
<div class="Header">

  <div class="HeaderLogo">
    <a href="/"><img src="/images/header_logo_transparent.png" alt="WesternDevs" title="WesternDevs" border="0" style="width: 206px; height: 64px;" width="206" height="64"></a>
  </div>

  <div class="HeaderLinks">
      <a href="/posts" class="nav">POSTS</a>       
      <a href="/podcasts" class="nav">PODCASTS</a>       
      <a href="/whoweare" class="nav">ABOUT</a>  
      <a href="/whatwevedone" class="nav">WHAT WE'VE DONE</a>  
      <a href="/speaking" class="nav">SPEAKING</a>
      <div class="HeaderIcons">
        <a href="mailto:info@westerndevs.com"><img src="/images/icon_email.png" border="0" alt="Email" title="Email" height="26" width="26"></a>
        <a href="/feed.xml"><img src="/images/icon_subscribe.png" border="0" alt="Subscribe" title="Subscribe" height="26" width="27"></a>
        <a href="http://twitter.com/westerndevs" target="_blank"><img src="/images/icon_twitter.png" border="0" alt="Twitter" title="Twitter" height="26" width="27"></a>
        <a href="http://github.com/westerndevs" target="_blank"><img src="/images/icon_github.png" border="0" alt="GitHub" title="GitHub" height="26" width="27"></a>     
      </div>
  </div>
  
</div>
</div>
</div>
<!--HEADER ENDS-->    



<!--WRAPPER STARTS-->
<div class="Wrapper" style="">

<!--SUBHEAD STARTS-->
<div class="WrapperSubHeaderSubpage">
<center>
	<div class="SubHeader">
		<H1 class="title"><img class="icon" src="/images/icon_posts.png" alt="POST" title="POST" border="0"> POST</H1>
	</div>
</center>
</div>
<!--SUBHEAD ENDS-->

<!--PAGE CONTENT STARTS-->
<center>
<div class="WrapperContent">

<!--MAIN CONTENT STARTS-->
	<div class="SubpageBoxSubLrg">
		<div class="SubpageBoxSubLrgContent">
		    <div class='postTitle'>
  <div class="ListLrgDateBG">
    <div class="ListLrgDateMonth">JUL</div>
    <div class="ListLrgDateDay">16</div>
    <div class="ListLrgDateYear">2016</div>
  </div>
  <h2>Loading View Components from a Class Library in ASP.NET Core MVC</h2>
</div>

		    

<p class="TXTsm">ORIGINALLY POSTED TO: <a href="http://www.davepaquette.com/archive/2016/07/16/loading-view-components-from-a-class-library-in-asp-net-core.aspx" target="_blank" rel="noopener" class='originalurl'>http://www.davepaquette.com/archive/2016/07/16/loading-view-components-from-a-class-library-in-asp-net-core.aspx</a></p>



			<div id="mainPostContent">
	        <p>In a previous post we explored the new <a href="http://www.davepaquette.com/archive/2016/01/02/goodbye-child-actions-hello-view-components.aspx" target="_blank" rel="noopener">View Component</a> feature of ASP.NET Core MVC. In today's post we take a look at how view components can be implemented in a separate class library and shared across multiple web applications.</p>
<h2>Creating a class library</h2>
<p>First, add a  a new .NET Core class library to your solution.</p>
<p><img src="http://www.davepaquette.com/images/external_view_components/create_new_class_library.png" alt="Add class library"></p>
<p>This is the class library where we will add our view components but before we can do that we have to add a reference to the MVC and Razor bits.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"dependencies"</span>: &#123;</span><br><span class="line">    <span class="string">"NETStandard.Library"</span>: <span class="string">"1.6.0"</span>,</span><br><span class="line">    <span class="string">"Microsoft.AspNetCore.Mvc"</span>: <span class="string">"1.0.0"</span>,</span><br><span class="line">    <span class="string">"Microsoft.AspNetCore.Razor.Tools"</span>: &#123;</span><br><span class="line">        <span class="string">"version"</span>: <span class="string">"1.0.0-preview2-final"</span>,</span><br><span class="line">        <span class="string">"type"</span>: <span class="string">"build"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br><span class="line"><span class="string">"tools"</span>: &#123;</span><br><span class="line">    <span class="string">"Microsoft.AspNetCore.Razor.Tools"</span>: <span class="string">"1.0.0-preview2-final"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Now we can add a view component class to the project. I created a simple example view component called <code>SimpleViewComponent</code>.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[ViewComponent(Name = <span class="string">"ViewComponentLibrary.Simple"</span>)]</span><br><span class="line">public class SimpleViewComponent : ViewComponent</span><br><span class="line">&#123;</span><br><span class="line">    public IViewComponentResult Invoke(int number)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> View(number + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>By convention, MVC would have assigned the name <code>Simple</code> to this view component. This view component is implemented in a class library with the intention of using it across multiple web apps which opens up the possibility of naming conflicts with other view components. To avoid naming conflicts, I overrode the name using the <code>[ViewComponent]</code> attribute and prefixed the name with the name of my class library.</p>
<p>Next, I added a <code>Default.cshtml</code> view to the <code>ViewComponentLibrary</code> in the <code>Views\Shared\Components\Simple</code> folder.</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@model Int32</span><br><span class="line"></span><br><span class="line">&lt;h1&gt;</span><br><span class="line">    Hello <span class="keyword">from</span> an external View Component!</span><br><span class="line">&lt;/h1&gt;</span><br><span class="line">&lt;h3&gt;Your number <span class="keyword">is</span> @Model&lt;/h3&gt;</span><br></pre></td></tr></table></figure> 
<p>For this view to be recognized by the web application, we need to include the <code>cshtml</code> files as embedded resources in the class library. Currently, this is done by adding the following setting to the <code>project.json</code> file.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"buildOptions"</span>: &#123;</span><br><span class="line">    <span class="string">"embed"</span>: <span class="string">"Views/**/*.cshtml"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure> 
<h2>Referencing external view components</h2>
<p>The first step in using the external view components in our web application project is to add a reference to the class library. Once the reference is added, we need tell the Razor view engine that views are stored as resources in the external view library. We can do this by adding some additional configuration code to the <code>ConfigureServices</code> method in <code>Startup.cs</code>. The additional code creates a new <code>EmbeddedFileProvider</code> for the class library then adds that file provider to the <code>RazorViewEngineOptions</code>.</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ConfigureServices</span>(<span class="params">IServiceCollection services</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// Add framework services.</span></span><br><span class="line">    services.AddApplicationInsightsTelemetry(Configuration);</span><br><span class="line"></span><br><span class="line">    services.AddMvc();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//Get a reference to the assembly that contains the view components</span></span><br><span class="line">    <span class="keyword">var</span> assembly = <span class="keyword">typeof</span>(ViewComponentLibrary.ViewComponents.SimpleViewComponent).GetTypeInfo().Assembly;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//Create an EmbeddedFileProvider for that assembly</span></span><br><span class="line">    <span class="keyword">var</span> embeddedFileProvider = <span class="keyword">new</span> EmbeddedFileProvider(</span><br><span class="line">        assembly,</span><br><span class="line">        <span class="string">"ViewComponentLibrary"</span></span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="comment">//Add the file provider to the Razor view engine</span></span><br><span class="line">    services.Configure&lt;RazorViewEngineOptions&gt;(options =&gt;</span><br><span class="line">    &#123;                </span><br><span class="line">        options.FileProviders.Add(embeddedFileProvider);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Now everything is wired up and we can invoke the view component just like we would for any other view component in our ASP.NET Core MVC application.</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;div <span class="keyword">class</span>=<span class="string">"row"</span>&gt;</span><br><span class="line">    @<span class="keyword">await</span> Component.InvokeAsync(<span class="string">"ViewComponentLibrary.Simple"</span>, <span class="keyword">new</span> &#123; number = <span class="number">5</span> &#125;)</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<h2>Wrapping it up</h2>
<p>Storing view components in a separate assembly allows them to be shared across multiple projects. It also opens up the possibility of creating a simple plugin architecture for your application. We will explore the plugin idea in more detail in a future post.</p>
<p>You can take a look at the full source code on <a href="https://github.com/AspNetMonsters/ExternalViewComponents" target="_blank" rel="noopener">GitHub</a>.</p>

	        </div>

            
            <section id="comments">
            <div id="disqus_thread">
                <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript" target="_blank" rel="noopener">comments powered by Disqus.</a></noscript>
            </div>
            </section>
            
		</div>
	</div>
<!--MAIN CONTENT ENDS-->

<!--SIDEBAR CONTENT STARTS-->
	<div class="SubpageBoxSubSm">
		<div class="SubpageBoxSubSmContent">
			
			

			<div class="ProfileImg">
				
				<a href="/bios/dave_paquette">
				
					<img src='/images/avatars/DavePaquette_241x241.jpg' />
				
				</a>
				
			</div>

			<BR clear="all">

			<h2><a href="/bios/dave_paquette">Dave Paquette</a></h2>
			
			<a href="mailto:contactme@davepaquette.com"><img class="ProfileIcon" src="/images/icon_email.png" border="0" alt="Email" title="Email"> Email</a><BR>
			
			
			<a href="http://www.davepaquette.com/" target="_blank"><img class="ProfileIcon" src="/images/icon_web.png" border="0" alt="Web" title="Web"> Web</a><BR>
			
			
			<a href="http://twitter.com/Dave_Paquette" target="_blank"><img class="ProfileIcon" src="/images/icon_twitter.png" border="0" alt="Twitter" title="Twitter"> Twitter</a><BR>
			
			
			<a href="https://github.com/dpaquette" target="_blank"><img class="ProfileIcon" src="/images/icon_github.png" border="0" alt="GitHub" title="GitHub"> GitHub</a><br>
			
			
			
 			<a href="/feeds/dave_paquette.xml"><img class="ProfileIcon" src="/images/icon_subscribe.png" /> RSS</a>
			

			<hr />
			<h4>Looking for someone else?</h4>
			<p>You can find the rest of the Western Devs Crew <a href="/whoweare">here</a>.</p>
		</div>
	</div>
<!--SIDEBAR CONTENT ENDS-->


</div>
</center>
<!--PAGE CONTENT ENDS-->


<!--FOOTER STARTS-->
<center>
  <div class="FooterBarTxt">&copy; 2015 Western Devs. All Rights Reserved. Design by <a href="http://www.karenchudobiak.ca" target="_blank">Karen Chudobiak, Graphic Designer</a></div>
</center>
<!--FOOTER ENDS-->

<!-- NAV FOOTER STARTS -->
<div class="NavFooter">
  <a href="/posts" alt="Posts"><i class="fa fa-newspaper-o fa-2x"></i><span>Posts</span></a>
  <a href="/podcasts" alt="Podcasts"><i class="fa fa-volume-up fa-2x"></i><span>Podcasts</span></a>
  <a href="/whoweare" alt="About"><i class="fa fa-star fa-2x"></i><span>About</span></a>
  <a href="/whatwevedone" alt="What We've Done"><i class="fa fa-trophy fa-2x"></i><span>Work</span></a>
  <a href="/speaking" alt="Speaking"><i class="fa fa-comment-o fa-2x fa-flip-horizontal"></i><span>Speaking</span></a>
</div>
<!-- NAV FOOTER ENDS -->




</div>
<!--WRAPPER ENDS-->


<script>
  var disqus_shortname = 'westerndevs';
  
  var disqus_url = 'https://westerndevs.com/ASP-NET-Core/View-Components/loading-view-components-from-a-class-library-in-asp-net-core/'.replace(".com//", ".com/");
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
  
function shuffle(array) {
  var currentIndex = array.length, temporaryValue, randomIndex;

  // While there remain elements to shuffle...
  while (0 !== currentIndex) {

    // Pick a remaining element...
    randomIndex = Math.floor(Math.random() * currentIndex);
    currentIndex -= 1;

    // And swap it with the current element.
    temporaryValue = array[currentIndex];
    array[currentIndex] = array[randomIndex];
    array[randomIndex] = temporaryValue;
  }

  return array;
}

</script>


</body>

  
<!-- Google Analytics -->
<script type="text/javascript">
if (document.location.hostname.search("westerndevs.com") !== -1 || document.location.hostname.search("www.westerndevs.com") !== -1) {
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-37617956-2', 'auto');

ga('set', 'contentGroup1', 'dave_paquette');

ga('send', 'pageview');
}
</script>
<!-- End Google Analytics -->



</html>
