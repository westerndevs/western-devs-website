<!DOCTYPE html>
<html lang="en" xml:lang="en">

  <head>
  
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>JSON Configuration in ASP.NET Core MVC | Western Devs</title>
  <meta name="description" content="Structured data in earlier versions of ASP.NET meant creating and registering custom types and configuration sections for our applications. In ASP.NET Core and in Core MVC, structured configuration is">
<meta property="og:type" content="article">
<meta property="og:title" content="JSON Configuration in ASP.NET Core MVC">
<meta property="og:url" content="https://westerndevs.com/ASP-NET-Core/json-config-in-aspnetcoremvc/index.html">
<meta property="og:site_name" content="Western Devs">
<meta property="og:description" content="Structured data in earlier versions of ASP.NET meant creating and registering custom types and configuration sections for our applications. In ASP.NET Core and in Core MVC, structured configuration is">
<meta property="og:image" content="https://jcblogimages.blob.core.windows.net/img/2016/01/json-structured-data.png">
<meta property="article:published_time" content="2016-01-22T02:36:09.000Z">
<meta property="article:modified_time" content="2024-08-31T00:01:11.043Z">
<meta property="article:author" content="Western Devs">
<meta property="article:tag" content="ASP.NET 5">
<meta property="article:tag" content="ASP.NET Core">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://jcblogimages.blob.core.windows.net/img/2016/01/json-structured-data.png">
<meta name="twitter:creator" content="@westerndevs">

    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="title" content="WesternDevs">   
    <meta name="keywords" content="software development,software,asp.net,blog">
    <meta name="description" content="We're all west of somewhere">
    <meta name="copyright" content="WesternDevs">
    <meta name="revisit-after" content="15 days">
    <meta name="robots" content="all">
    <meta name="MSSmartTagsPreventParsing" content="true">
  
    <link rel="canonical" href="http://jameschambers.com/2016/01/json-config-in-aspnetcoremvc/">
  
  
    <link rel="alternate" href="/feed.xml" title="Western Devs" type="application/atom+xml">
  
  
<link rel="stylesheet" href="/css/style.css">

      
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <script src="//code.jquery.com/jquery-1.11.3.min.js"></script>  
  <meta name="generator" content="Hexo 4.2.1"></head>

<body>

<!-- FIXED HEADER BECAUSE SCROLLING -->
<!--HEADER STARTS-->
<div class="WrapperHeader">
<div style="display:inline-block; text-align: center;">
<div class="Header">

  <div class="HeaderLogo">
    <a href="/"><img src="/images/header_logo_transparent.png" alt="WesternDevs" title="WesternDevs" border="0" style="width: 206px; height: 64px;" width="206" height="64"></a>
  </div>

  <div class="HeaderLinks">
      <a href="/posts" class="nav">POSTS</a>       
      <a href="/podcasts" class="nav">PODCASTS</a>       
      <a href="/whoweare" class="nav">ABOUT</a>  
      <a href="/whatwevedone" class="nav">WHAT WE'VE DONE</a>  
      <a href="/speaking" class="nav">SPEAKING</a>
      <div class="HeaderIcons">
        <a href="mailto:info@westerndevs.com"><img src="/images/icon_email.png" border="0" alt="Email" title="Email" height="26" width="26"></a>
        <a href="/feed.xml"><img src="/images/icon_subscribe.png" border="0" alt="Subscribe" title="Subscribe" height="26" width="27"></a>
        <a href="http://twitter.com/westerndevs" target="_blank"><img src="/images/icon_twitter.png" border="0" alt="Twitter" title="Twitter" height="26" width="27"></a>
        <a href="http://github.com/westerndevs" target="_blank"><img src="/images/icon_github.png" border="0" alt="GitHub" title="GitHub" height="26" width="27"></a>     
      </div>
  </div>
  
</div>
</div>
</div>
<!--HEADER ENDS-->    



<!--WRAPPER STARTS-->
<div class="Wrapper" style="">

<!--SUBHEAD STARTS-->
<div class="WrapperSubHeaderSubpage">
<center>
	<div class="SubHeader">
		<H1 class="title"><img class="icon" src="/images/icon_posts.png" alt="POST" title="POST" border="0"> POST</H1>
	</div>
</center>
</div>
<!--SUBHEAD ENDS-->

<!--PAGE CONTENT STARTS-->
<center>
<div class="WrapperContent">

<!--MAIN CONTENT STARTS-->
	<div class="SubpageBoxSubLrg">
		<div class="SubpageBoxSubLrgContent">
		    <div class='postTitle'>
  <div class="ListLrgDateBG">
    <div class="ListLrgDateMonth">JAN</div>
    <div class="ListLrgDateDay">22</div>
    <div class="ListLrgDateYear">2016</div>
  </div>
  <h2>JSON Configuration in ASP.NET Core MVC</h2>
</div>

		    

<p class="TXTsm">ORIGINALLY POSTED TO: <a href="http://jameschambers.com/2016/01/json-config-in-aspnetcoremvc/" target="_blank" rel="noopener" class='originalurl'>http://jameschambers.com/2016/01/json-config-in-aspnetcoremvc/</a></p>



			<div id="mainPostContent">
	        <p>Structured data in earlier versions of ASP.NET meant creating and registering custom types and configuration sections for our applications. In ASP.NET Core and in Core MVC, structured configuration is a breeze with support for JSON documents as the storage mechanism and the ability to flatten hierarchies into highly portable keys.</p>
<p><img src="https://jcblogimages.blob.core.windows.net:443/img/2016/01/json-structured-data.png" alt="Structured JSON Configuration"></p>
<a id="more"></a>
<p>You can see from the document snippet above, taken from the default project template, that we can easily achieve a well-structured, human-readible set of data.  Where we used to do something the the following:</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;appSettings&gt;</span><br><span class="line">  &lt;<span class="keyword">add</span> key=<span class="string">"Logging-IncludeScopes"</span> <span class="keyword">value</span>=<span class="string">"false"</span> /&gt;</span><br><span class="line">  &lt;<span class="keyword">add</span> key=<span class="string">"Logging-Level-Default"</span> <span class="keyword">value</span>=<span class="string">"verbose"</span> /&gt;</span><br><span class="line">  &lt;<span class="keyword">add</span> key=<span class="string">"Logging-Level-System"</span> <span class="keyword">value</span>=<span class="string">"Information"</span> /&gt;</span><br><span class="line">  &lt;<span class="keyword">add</span> key=<span class="string">"Logging-Level-Microsoft"</span> <span class="keyword">value</span>=<span class="string">"Information"</span> /&gt;</span><br><span class="line">&lt;/appSettings&gt;</span><br></pre></td></tr></table></figure>
<p>Our other option, of course, is going the custom object route, but that has always been a pain in the rear. Today we can do this:</p>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"Logging"</span>: &#123;</span><br><span class="line">  <span class="string">"IncludeScopes"</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="string">"LogLevel"</span>: &#123;</span><br><span class="line">    <span class="string">"Default"</span>: <span class="string">"Verbose"</span>,</span><br><span class="line">    <span class="string">"System"</span>: <span class="string">"Information"</span>,</span><br><span class="line">    <span class="string">"Microsoft"</span>: <span class="string">"Information"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Now the data that we have related to logging can be grouped into a logical fragment of the configuration file and can grow as required.</p>
<h2>Exploring a Common Example</h2>
<p>This organization is great and comes along with the benefit of being collapsable into a key-value pair.  We see evidence of this in the connection string, which is also located in the <code>appsettings.json</code> file:</p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"Data"</span>: &#123;</span><br><span class="line">  <span class="string">"DefaultConnection"</span>: &#123;</span><br><span class="line">    <span class="string">"ConnectionString"</span>: <span class="string">"Server=(localdb)\\mssqllocaldb;Database=aspnet5-ConfigurationSample-ad90971f-6620-4bc1-ad28-650c59478cc1;Trusted_Connection=True;MultipleActiveResultSets=true"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>And when you want to pull it out of the stored configuration, you do so like this example from <code>startup.cs</code>:</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">services.<span class="keyword">AddEntityFramework()</span></span><br><span class="line"><span class="keyword"> </span>   .<span class="keyword">AddSqlServer()</span></span><br><span class="line"><span class="keyword"> </span>   .<span class="keyword">AddDbContext&lt;ApplicationDbContext&gt;(options </span>=&gt;</span><br><span class="line">        options.UseSqlServer(Configuration[<span class="string">"Data:DefaultConnection:ConnectionString"</span>]));</span><br></pre></td></tr></table></figure>
<p>Notice how the value of the <code>ConnectionString</code> property of the <code>DefaultConnection</code> object within the <code>Data</code> object at the root was stored as the key <code>Data:DefaultConnection:ConnectionString</code>. This is perfect for allowing overrides, such as using environment variables. This is further made handy by the fact that your settings in Azure are automatically loaded as environment variables into your application execution process at startup.</p>
<p>In your Azure Web App configuration, you would simply need to add a key named <code>Data:DefaultConnection:ConnectionString</code> and set the value accordingly. This means that developers can use LocalDB locally, and the app automatically lights up in the cloud with the real database.</p>
<h2>Next Up</h2>
<p>These key-value pairs are great, but in your application it would be a bother to have to load out each property by hand. In my next post I'm going to show you how to take a configuration section and turn it into a set of typed configuration options that can be used throughout your project.</p>
<p>Happy coding!</p>

	        </div>

            
            <section id="comments">
            <div id="disqus_thread">
                <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript" target="_blank" rel="noopener">comments powered by Disqus.</a></noscript>
            </div>
            </section>
            
		</div>
	</div>
<!--MAIN CONTENT ENDS-->

<!--SIDEBAR CONTENT STARTS-->
	<div class="SubpageBoxSubSm">
		<div class="SubpageBoxSubSmContent">
			
			

			<div class="ProfileImg">
				
				<a href="/bios/james_chambers">
				
					<img src='https://www.gravatar.com/avatar/1ac8c631c34a86ddcfb6ae67f6a7a551?s=200' />
				
				</a>
				
			</div>

			<BR clear="all">

			<h2><a href="/bios/james_chambers">James Chambers</a></h2>
			
			<a href="mailto:james@jameschambers.com"><img class="ProfileIcon" src="/images/icon_email.png" border="0" alt="Email" title="Email"> Email</a><BR>
			
			
			<a href="http://jameschambers.com/" target="_blank"><img class="ProfileIcon" src="/images/icon_web.png" border="0" alt="Web" title="Web"> Web</a><BR>
			
			
			<a href="http://twitter.com/canadianjames" target="_blank"><img class="ProfileIcon" src="/images/icon_twitter.png" border="0" alt="Twitter" title="Twitter"> Twitter</a><BR>
			
			
			<a href="https://github.com/MisterJames" target="_blank"><img class="ProfileIcon" src="/images/icon_github.png" border="0" alt="GitHub" title="GitHub"> GitHub</a><br>
			
			
			<a href="https://www.linkedin.com/in/canadianjames" target="_blank"><img class="ProfileIcon" src="/images/icon_linkedin.png" border="0" alt="LinkedIN" title="LinkedIN"> LinkedIn</a><br>
			
			
 			<a href="/feeds/james_chambers.xml"><img class="ProfileIcon" src="/images/icon_subscribe.png" /> RSS</a>
			

			<hr />
			<h4>Looking for someone else?</h4>
			<p>You can find the rest of the Western Devs Crew <a href="/whoweare">here</a>.</p>
		</div>
	</div>
<!--SIDEBAR CONTENT ENDS-->


</div>
</center>
<!--PAGE CONTENT ENDS-->


<!--FOOTER STARTS-->
<center>
  <div class="FooterBarTxt">&copy; 2015 Western Devs. All Rights Reserved. Design by <a href="http://www.karenchudobiak.ca" target="_blank">Karen Chudobiak, Graphic Designer</a></div>
</center>
<!--FOOTER ENDS-->

<!-- NAV FOOTER STARTS -->
<div class="NavFooter">
  <a href="/posts" alt="Posts"><i class="fa fa-newspaper-o fa-2x"></i><span>Posts</span></a>
  <a href="/podcasts" alt="Podcasts"><i class="fa fa-volume-up fa-2x"></i><span>Podcasts</span></a>
  <a href="/whoweare" alt="About"><i class="fa fa-star fa-2x"></i><span>About</span></a>
  <a href="/whatwevedone" alt="What We've Done"><i class="fa fa-trophy fa-2x"></i><span>Work</span></a>
  <a href="/speaking" alt="Speaking"><i class="fa fa-comment-o fa-2x fa-flip-horizontal"></i><span>Speaking</span></a>
</div>
<!-- NAV FOOTER ENDS -->




</div>
<!--WRAPPER ENDS-->


<script>
  var disqus_shortname = 'westerndevs';
  
  var disqus_url = 'https://westerndevs.com/ASP-NET-Core/json-config-in-aspnetcoremvc/'.replace(".com//", ".com/");
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
  
function shuffle(array) {
  var currentIndex = array.length, temporaryValue, randomIndex;

  // While there remain elements to shuffle...
  while (0 !== currentIndex) {

    // Pick a remaining element...
    randomIndex = Math.floor(Math.random() * currentIndex);
    currentIndex -= 1;

    // And swap it with the current element.
    temporaryValue = array[currentIndex];
    array[currentIndex] = array[randomIndex];
    array[randomIndex] = temporaryValue;
  }

  return array;
}

</script>


</body>

  
<!-- Google Analytics -->
<script type="text/javascript">
if (document.location.hostname.search("westerndevs.com") !== -1 || document.location.hostname.search("www.westerndevs.com") !== -1) {
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-37617956-2', 'auto');

ga('set', 'contentGroup1', 'james_chambers');

ga('send', 'pageview');
}
</script>
<!-- End Google Analytics -->



</html>
