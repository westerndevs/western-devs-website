<!DOCTYPE html>
<html lang="en" xml:lang="en">

  <head>
  
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>You&#39;re using HttpClient wrong and it is destabilizing your software | Western Devs</title>
  <meta name="description" content="I&#39;ve been using HttpClient wrong for years and it finally came back to bite me. My site was unstable and my clients furious, with a simple fix performance improved greatly and the instability disapear">
<meta property="og:type" content="article">
<meta property="og:title" content="You&#39;re using HttpClient wrong and it is destabilizing your software">
<meta property="og:url" content="https://westerndevs.com/Deployment/httpclientwrong/index.html">
<meta property="og:site_name" content="Western Devs">
<meta property="og:description" content="I&#39;ve been using HttpClient wrong for years and it finally came back to bite me. My site was unstable and my clients furious, with a simple fix performance improved greatly and the instability disapear">
<meta property="og:image" content="http://i.imgur.com/EctiaBj.jpg">
<meta property="og:image" content="http://i.imgur.com/rXxnIA8.png">
<meta property="og:image" content="http://i.imgur.com/0QVdLMT.png">
<meta property="article:published_time" content="2016-08-28T21:36:36.000Z">
<meta property="article:modified_time" content="2022-11-14T04:58:16.665Z">
<meta property="article:author" content="Western Devs">
<meta property="article:tag" content=".net">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://i.imgur.com/EctiaBj.jpg">
<meta name="twitter:creator" content="@westerndevs">

    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="title" content="WesternDevs">   
    <meta name="keywords" content="software development,software,asp.net,blog">
    <meta name="description" content="We're all west of somewhere">
    <meta name="copyright" content="WesternDevs">
    <meta name="revisit-after" content="15 days">
    <meta name="robots" content="all">
    <meta name="MSSmartTagsPreventParsing" content="true">
  
  
    <link rel="alternate" href="/feed.xml" title="Western Devs" type="application/atom+xml">
  
  
<link rel="stylesheet" href="/css/style.css">

      
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <script src="//code.jquery.com/jquery-1.11.3.min.js"></script>  
  <meta name="generator" content="Hexo 4.2.1"></head>

<body>

<!-- FIXED HEADER BECAUSE SCROLLING -->
<!--HEADER STARTS-->
<div class="WrapperHeader">
<div style="display:inline-block; text-align: center;">
<div class="Header">

  <div class="HeaderLogo">
    <a href="/"><img src="/images/header_logo_transparent.png" alt="WesternDevs" title="WesternDevs" border="0" style="width: 206px; height: 64px;" width="206" height="64"></a>
  </div>

  <div class="HeaderLinks">
      <a href="/posts" class="nav">POSTS</a>       
      <a href="/podcasts" class="nav">PODCASTS</a>       
      <a href="/whoweare" class="nav">ABOUT</a>  
      <a href="/whatwevedone" class="nav">WHAT WE'VE DONE</a>  
      <a href="/speaking" class="nav">SPEAKING</a>
      <div class="HeaderIcons">
        <a href="mailto:info@westerndevs.com"><img src="/images/icon_email.png" border="0" alt="Email" title="Email" height="26" width="26"></a>
        <a href="/feed.xml"><img src="/images/icon_subscribe.png" border="0" alt="Subscribe" title="Subscribe" height="26" width="27"></a>
        <a href="http://twitter.com/westerndevs" target="_blank"><img src="/images/icon_twitter.png" border="0" alt="Twitter" title="Twitter" height="26" width="27"></a>
        <a href="http://github.com/westerndevs" target="_blank"><img src="/images/icon_github.png" border="0" alt="GitHub" title="GitHub" height="26" width="27"></a>     
      </div>
  </div>
  
</div>
</div>
</div>
<!--HEADER ENDS-->    



<!--WRAPPER STARTS-->
<div class="Wrapper" style="">

<!--SUBHEAD STARTS-->
<div class="WrapperSubHeaderSubpage">
<center>
	<div class="SubHeader">
		<H1 class="title"><img class="icon" src="/images/icon_posts.png" alt="POST" title="POST" border="0"> POST</H1>
	</div>
</center>
</div>
<!--SUBHEAD ENDS-->

<!--PAGE CONTENT STARTS-->
<center>
<div class="WrapperContent">

<!--MAIN CONTENT STARTS-->
	<div class="SubpageBoxSubLrg">
		<div class="SubpageBoxSubLrgContent">
		    <div class='postTitle'>
  <div class="ListLrgDateBG">
    <div class="ListLrgDateMonth">AUG</div>
    <div class="ListLrgDateDay">28</div>
    <div class="ListLrgDateYear">2016</div>
  </div>
  <h2>You&#39;re using HttpClient wrong and it is destabilizing your software</h2>
</div>

		    

			<div id="mainPostContent">
	        <p>I've been using HttpClient wrong for years and it finally came back to bite me. My site was unstable and my clients furious, with a simple fix performance improved greatly and the instability disapeared.</p>
<p><img src="http://i.imgur.com/EctiaBj.jpg" alt="Imgur"></p>
<p>At the same time I actually improved the performance of the application through more efficient socket usage.</p>
<a id="more"></a>
<p>Microservices can be a bear to deal with. As more services are added and monoliths are broken down there tends to be more communication paths between services. There are many options for communicating, but HTTP is an ever popular option. If the microservies are built in C# or any .NET language then chances are you've made use of <code>HttpClient</code>. I know I did.</p>
<p>The typical usage pattern looked a little bit like this:</p>
<figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span>(<span class="keyword">var</span> client = <span class="keyword">new</span> <span class="type">HttpClient</span>())</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//do something with http client</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2>Here's the Rub</h2>
<p>The <code>using</code> statement is a C# nicity for dealing with disposable objects. Once the <code>using</code> block is complete then the disposable object, in this case <code>HttpClient</code>, goes out of scope and is disposed. The <code>dispose</code> method is called and whatever resources are in use are cleaned up. This is a very typical pattern in .NET and we use it for everything from database connections to stream writers. Really any object which has external resources that must be clean up uses the <code>IDisposable</code> interface.</p>
<p>And you can't be blamed for wanting to wrap it with the using. First of all, it's considered good practice to do so. In fact, the <a href="https://msdn.microsoft.com/en-ca/library/yh598w02.aspx" target="_blank" rel="noopener">official docs</a> for <code>using</code> state:</p>
<blockquote>
<p>As a rule, when you use an IDisposable object, you should declare and instantiate it in a using statement.</p>
</blockquote>
<p>Secondly, all code you may have seen since...the inception of <code>HttpClient</code> would have told you to use a <code>using</code> statement block, including recent docs on the <a href="http://www.asp.net/web-api/overview/advanced/calling-a-web-api-from-a-net-client" target="_blank" rel="noopener">ASP.NET site itself</a>. The internet is generally <a href="http://stackoverflow.com/questions/212198/what-is-the-c-sharp-using-block-and-why-should-i-use-it" target="_blank" rel="noopener">in agreement as well</a>.</p>
<p>But <code>HttpClient</code> is different. Although it implements the <code>IDisposable</code> interface it is actually a shared object. This means that under the covers it is <a href="https://en.wikipedia.org/wiki/Reentrancy_(computing)" target="_blank" rel="noopener">reentrant</a> and thread safe. Instead of creating a new instance of <code>HttpClient</code> for each execution you should share a single instance of <code>HttpClient</code> for the entire lifetime of the application. Let's look at why.</p>
<h2>See For Yourself</h2>
<p>Here is a simple program written to demonstrate the use of <code>HttpClient</code>:</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">using System;</span><br><span class="line">using System.Net.Http;</span><br><span class="line"></span><br><span class="line">namespace ConsoleApplication</span><br><span class="line">&#123;</span><br><span class="line">    public class Program</span><br><span class="line">    &#123;</span><br><span class="line">        public static void Main(string[] args)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">"Starting connections"</span>);</span><br><span class="line">            <span class="keyword">for</span>(int i = 0; i&lt;10; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                using(var<span class="built_in"> client </span>= new HttpClient())</span><br><span class="line">                &#123;</span><br><span class="line">                    var result = client.GetAsync(<span class="string">"http://aspnetmonsters.com"</span>).Result;</span><br><span class="line">                    Console.WriteLine(result.StatusCode);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            Console.WriteLine(<span class="string">"Connections done"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>This will open up 10 requests to one of the best sites on the internet <a href="http://aspnetmonsters.com" target="_blank" rel="noopener">http://aspnetmonsters.com</a> and do a <code>GET</code>. We just print the status code so we know it is working. The output is going to be:</p>
<figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">C:\code\socket&gt; dotnet run</span><br><span class="line">Project socket (.NETCoreApp,Version=v1.0) will be compiled because inputs were modified</span><br><span class="line">Compiling socket for .NETCoreApp,Version=v1.0</span><br><span class="line"></span><br><span class="line">Compilation succeeded.</span><br><span class="line">   <span class="number"> 0 </span>Warning(s)</span><br><span class="line">   <span class="number"> 0 </span>Error(s)</span><br><span class="line"></span><br><span class="line">Time elapsed 00:00:01.2501667</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Starting connections</span><br><span class="line"><span class="symbol">OK</span></span><br><span class="line"><span class="symbol">OK</span></span><br><span class="line"><span class="symbol">OK</span></span><br><span class="line"><span class="symbol">OK</span></span><br><span class="line"><span class="symbol">OK</span></span><br><span class="line"><span class="symbol">OK</span></span><br><span class="line"><span class="symbol">OK</span></span><br><span class="line"><span class="symbol">OK</span></span><br><span class="line"><span class="symbol">OK</span></span><br><span class="line"><span class="symbol">OK</span></span><br><span class="line">Connections done</span><br></pre></td></tr></table></figure>
<h2>But Wait, There's More!</h2>
<p>All work and everything is right with the world. Except that it isn't. If we pull out the <code>netstat</code> tool and look at the state of sockets on the machine running this we'll see:</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">C</span>:\<span class="selector-tag">code</span>\<span class="selector-tag">socket</span>&gt;<span class="selector-tag">NETSTAT</span><span class="selector-class">.EXE</span></span><br><span class="line">...</span><br><span class="line">  <span class="selector-tag">Proto</span>  <span class="selector-tag">Local</span> <span class="selector-tag">Address</span>          <span class="selector-tag">Foreign</span> <span class="selector-tag">Address</span>        <span class="selector-tag">State</span></span><br><span class="line">  <span class="selector-tag">TCP</span>    10<span class="selector-class">.211</span><span class="selector-class">.55</span><span class="selector-class">.6</span><span class="selector-pseudo">:12050</span>      <span class="selector-tag">waws-prod-bay-017</span><span class="selector-pseudo">:http</span>  <span class="selector-tag">TIME_WAIT</span></span><br><span class="line">  <span class="selector-tag">TCP</span>    10<span class="selector-class">.211</span><span class="selector-class">.55</span><span class="selector-class">.6</span><span class="selector-pseudo">:12051</span>      <span class="selector-tag">waws-prod-bay-017</span><span class="selector-pseudo">:http</span>  <span class="selector-tag">TIME_WAIT</span></span><br><span class="line">  <span class="selector-tag">TCP</span>    10<span class="selector-class">.211</span><span class="selector-class">.55</span><span class="selector-class">.6</span><span class="selector-pseudo">:12053</span>      <span class="selector-tag">waws-prod-bay-017</span><span class="selector-pseudo">:http</span>  <span class="selector-tag">TIME_WAIT</span></span><br><span class="line">  <span class="selector-tag">TCP</span>    10<span class="selector-class">.211</span><span class="selector-class">.55</span><span class="selector-class">.6</span><span class="selector-pseudo">:12054</span>      <span class="selector-tag">waws-prod-bay-017</span><span class="selector-pseudo">:http</span>  <span class="selector-tag">TIME_WAIT</span></span><br><span class="line">  <span class="selector-tag">TCP</span>    10<span class="selector-class">.211</span><span class="selector-class">.55</span><span class="selector-class">.6</span><span class="selector-pseudo">:12055</span>      <span class="selector-tag">waws-prod-bay-017</span><span class="selector-pseudo">:http</span>  <span class="selector-tag">TIME_WAIT</span></span><br><span class="line">  <span class="selector-tag">TCP</span>    10<span class="selector-class">.211</span><span class="selector-class">.55</span><span class="selector-class">.6</span><span class="selector-pseudo">:12056</span>      <span class="selector-tag">waws-prod-bay-017</span><span class="selector-pseudo">:http</span>  <span class="selector-tag">TIME_WAIT</span></span><br><span class="line">  <span class="selector-tag">TCP</span>    10<span class="selector-class">.211</span><span class="selector-class">.55</span><span class="selector-class">.6</span><span class="selector-pseudo">:12057</span>      <span class="selector-tag">waws-prod-bay-017</span><span class="selector-pseudo">:http</span>  <span class="selector-tag">TIME_WAIT</span></span><br><span class="line">  <span class="selector-tag">TCP</span>    10<span class="selector-class">.211</span><span class="selector-class">.55</span><span class="selector-class">.6</span><span class="selector-pseudo">:12058</span>      <span class="selector-tag">waws-prod-bay-017</span><span class="selector-pseudo">:http</span>  <span class="selector-tag">TIME_WAIT</span></span><br><span class="line">  <span class="selector-tag">TCP</span>    10<span class="selector-class">.211</span><span class="selector-class">.55</span><span class="selector-class">.6</span><span class="selector-pseudo">:12059</span>      <span class="selector-tag">waws-prod-bay-017</span><span class="selector-pseudo">:http</span>  <span class="selector-tag">TIME_WAIT</span></span><br><span class="line">  <span class="selector-tag">TCP</span>    10<span class="selector-class">.211</span><span class="selector-class">.55</span><span class="selector-class">.6</span><span class="selector-pseudo">:12060</span>      <span class="selector-tag">waws-prod-bay-017</span><span class="selector-pseudo">:http</span>  <span class="selector-tag">TIME_WAIT</span></span><br><span class="line">  <span class="selector-tag">TCP</span>    10<span class="selector-class">.211</span><span class="selector-class">.55</span><span class="selector-class">.6</span><span class="selector-pseudo">:12061</span>      <span class="selector-tag">waws-prod-bay-017</span><span class="selector-pseudo">:http</span>  <span class="selector-tag">TIME_WAIT</span></span><br><span class="line">  <span class="selector-tag">TCP</span>    10<span class="selector-class">.211</span><span class="selector-class">.55</span><span class="selector-class">.6</span><span class="selector-pseudo">:12062</span>      <span class="selector-tag">waws-prod-bay-017</span><span class="selector-pseudo">:http</span>  <span class="selector-tag">TIME_WAIT</span></span><br><span class="line">  <span class="selector-tag">TCP</span>    127<span class="selector-class">.0</span><span class="selector-class">.0</span><span class="selector-class">.1</span><span class="selector-pseudo">:1695</span>         <span class="selector-tag">SIMONTIMMS742B</span><span class="selector-pseudo">:1696</span>    <span class="selector-tag">ESTABLISHED</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>Huh, that's weird...the application has exited and yet there are still a bunch of these connections open to the Azure machine which hosts the ASP.NET Monsters website. They are in the <code>TIME_WAIT</code> state which means that the connection has been closed on one side (ours) but we're still waiting to see if any additional packets come in on it because they might have been delayed on the network somewhere. Here is a diagram of TCP/IP states I stole from https://www4.cs.fau.de/Projects/JX/Projects/TCP/tcpstate.html.</p>
<p><img src="http://i.imgur.com/rXxnIA8.png" alt="Imgur"></p>
<p>Windows will hold a connection in this state for 240 seconds (It is set by <code>[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\TcpTimedWaitDelay]</code>). There is a limit to how quickly Windows can open new sockets so if you exhaust the connection pool then you're likely to see error like:</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Unable <span class="keyword">to</span> connect <span class="keyword">to</span> the remote server</span><br><span class="line">System.Net.Sockets.SocketException: Only one usage of each socket<span class="built_in"> address </span>(protocol<span class="built_in">/network </span>address/port) is normally permitted.</span><br></pre></td></tr></table></figure>
<p>Searching for that in the Googles will give you some terrible advice about decreasing the connection timeout. In fact, decreasing the timeout can lead to other detrimental consequences when applications that properly use <code>HttpClient</code> or similar constructs are run on the server. We need to understand what &quot;properly&quot; means and fix the underlying problem instead of tinkering with machine level variables.</p>
<h2>The Fix is In</h2>
<p>I really must thank <a href="https://twitter.com/hsulriksen" target="_blank" rel="noopener">Harald S. Ulrksen</a> and <a href="https://twitter.com/darrel_miller" target="_blank" rel="noopener">Darrel Miller</a> for pointing me to <a href="https://t.co/bewSxPqlps" target="_blank" rel="noopener">The Patterns and Practices documents</a> on this.</p>
<p>If we share a single instance of <code>HttpClient</code> then we can reduce the waste of sockets by reusing them:</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Net.Http;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> ConsoleApplication</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Program</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">HttpClient</span> <span class="built_in">Client</span> = <span class="keyword">new</span> <span class="built_in">HttpClient</span>();</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span><span class="params">(<span class="built_in">string</span>[] args)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="built_in">Console</span>.WriteLine(<span class="string">"Starting connections"</span>);</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i&lt;<span class="number">10</span>; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                var result = <span class="built_in">Client</span>.GetAsync(<span class="string">"http://aspnetmonsters.com"</span>).Result;</span><br><span class="line">                <span class="built_in">Console</span>.WriteLine(result.StatusCode);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">Console</span>.WriteLine(<span class="string">"Connections done"</span>);</span><br><span class="line">            <span class="built_in">Console</span>.ReadLine();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Note here that we have just one instance of <code>HttpClient</code> shared for the entire application. Eveything still works like it use to (actually a little faster due to socket reuse). Netstat now just shows:</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TCP    <span class="number">10.211</span><span class="number">.55</span><span class="number">.6</span>:<span class="number">12254</span>      waws-prod-bay<span class="number">-017</span>:http  ESTABLISHED</span><br></pre></td></tr></table></figure>
<p>In the production scenario I had the number of sockets was averaging around 4000, and at peak would exceed 5000, effectively crushing the available resources on the server, which then caused services to fall over. After implementing the change, the sockets in use dropped from an average of more than 4000 to being consistently less than 400, and usually around 100.</p>
<p>This is a chunk of a graph from our monitoring tools and shows what happened after we deployed a limited proof of the fix to a select number of microservices.</p>
<p><img src="http://i.imgur.com/0QVdLMT.png" alt="Imgur"></p>
<p>This is dramatic. If you have any kind of load at all you need to remember these two things:</p>
<ol>
<li>Make your <code>HttpClient</code> static.</li>
<li>Do <em>not</em> dispose of or wrap your <code>HttpClient</code> in a using unless you explicitly are looking for a particular behaviour (such as causing your services to fail).</li>
</ol>
<h2>Wrapping Up</h2>
<p>The socket exhaustion problems we had been struggling with for months disapeared and our client threw a virtual parade. I cannot understate how unobvious this bug was. For years we have been conditioned to dispose of objects that implement <code>IDisposable</code> and many refactoring tools like R# and CodeRush actually warn if you don't. In this case disposing of <code>HttpClient</code> was the wrong thing to do. It is unfortunate that <code>HttpClient</code> implements <code>IDisposable</code> and encourages the wrong behaviour</p>

	        </div>

            
            <section id="comments">
            <div id="disqus_thread">
                <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript" target="_blank" rel="noopener">comments powered by Disqus.</a></noscript>
            </div>
            </section>
            
		</div>
	</div>
<!--MAIN CONTENT ENDS-->

<!--SIDEBAR CONTENT STARTS-->
	<div class="SubpageBoxSubSm">
		<div class="SubpageBoxSubSmContent">
			
			

			<div class="ProfileImg">
				
				<a href="/bios/simon_timms">
				
					<img src='/images/avatars/simon.jpg' />
				
				</a>
				
			</div>

			<BR clear="all">

			<h2><a href="/bios/simon_timms">Simon Timms</a></h2>
			
			<a href="mailto:stimms@gmail.com"><img class="ProfileIcon" src="/images/icon_email.png" border="0" alt="Email" title="Email"> Email</a><BR>
			
			
			<a href="http://blog.simontimms.com/" target="_blank"><img class="ProfileIcon" src="/images/icon_web.png" border="0" alt="Web" title="Web"> Web</a><BR>
			
			
			<a href="http://twitter.com/stimms" target="_blank"><img class="ProfileIcon" src="/images/icon_twitter.png" border="0" alt="Twitter" title="Twitter"> Twitter</a><BR>
			
			
			<a href="https://github.com/stimms" target="_blank"><img class="ProfileIcon" src="/images/icon_github.png" border="0" alt="GitHub" title="GitHub"> GitHub</a><br>
			
			
			
 			<a href="/feeds/simon_timms.xml"><img class="ProfileIcon" src="/images/icon_subscribe.png" /> RSS</a>
			

			<hr />
			<h4>Looking for someone else?</h4>
			<p>You can find the rest of the Western Devs Crew <a href="/whoweare">here</a>.</p>
		</div>
	</div>
<!--SIDEBAR CONTENT ENDS-->


</div>
</center>
<!--PAGE CONTENT ENDS-->


<!--FOOTER STARTS-->
<center>
  <div class="FooterBarTxt">&copy; 2015 Western Devs. All Rights Reserved. Design by <a href="http://www.karenchudobiak.ca" target="_blank">Karen Chudobiak, Graphic Designer</a></div>
</center>
<!--FOOTER ENDS-->

<!-- NAV FOOTER STARTS -->
<div class="NavFooter">
  <a href="/posts" alt="Posts"><i class="fa fa-newspaper-o fa-2x"></i><span>Posts</span></a>
  <a href="/podcasts" alt="Podcasts"><i class="fa fa-volume-up fa-2x"></i><span>Podcasts</span></a>
  <a href="/whoweare" alt="About"><i class="fa fa-star fa-2x"></i><span>About</span></a>
  <a href="/whatwevedone" alt="What We've Done"><i class="fa fa-trophy fa-2x"></i><span>Work</span></a>
  <a href="/speaking" alt="Speaking"><i class="fa fa-comment-o fa-2x fa-flip-horizontal"></i><span>Speaking</span></a>
</div>
<!-- NAV FOOTER ENDS -->




</div>
<!--WRAPPER ENDS-->


<script>
  var disqus_shortname = 'westerndevs';
  
  var disqus_url = 'https://westerndevs.com/Deployment/httpclientwrong/'.replace(".com//", ".com/");
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
  
function shuffle(array) {
  var currentIndex = array.length, temporaryValue, randomIndex;

  // While there remain elements to shuffle...
  while (0 !== currentIndex) {

    // Pick a remaining element...
    randomIndex = Math.floor(Math.random() * currentIndex);
    currentIndex -= 1;

    // And swap it with the current element.
    temporaryValue = array[currentIndex];
    array[currentIndex] = array[randomIndex];
    array[randomIndex] = temporaryValue;
  }

  return array;
}

</script>


</body>

  
<!-- Google Analytics -->
<script type="text/javascript">
if (document.location.hostname.search("westerndevs.com") !== -1 || document.location.hostname.search("www.westerndevs.com") !== -1) {
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-37617956-2', 'auto');

ga('set', 'contentGroup1', 'simon_timms');

ga('send', 'pageview');
}
</script>
<!-- End Google Analytics -->



</html>
